=== Job Information ===
Job ID: 12566042
Node: gcn113
Start time: Mon Jun 23 10:40:42 CEST 2025
Available GPUs: 0,1,2,3
Available CPUs: 32
Available Memory: 245760
============================================================================================== 
Warning! Mixing Conda and module environments may lead to corruption of the
user environment. 
We do not recommend users mixing those two environments unless absolutely
necessary. Note that 
SURF does not provide any support for Conda environment.
For more information, please refer to our software policy page:
https://servicedesk.surf.nl/wiki/display/WIKI/Software+policy+Snellius#SoftwarepolicySnellius-UseofAnacondaandMinicondaenvironmentsonSnellius 

Remember that many packages have already been installed on the system and can
be loaded using 
the 'module load <package__name>' command. If you are uncertain if a package is
already available 
on the system, please use 'module avail' or 'module spider' to search for it.
============================================================================================== 
=== Environment Check ===
PyTorch version: 2.7.1+cu126
CUDA available: True
CUDA devices: 4
Starting Optimized RecFormer fine-tuning using the MIND dataset...
=== Training Configuration ===
Multi-GPU: 4 H100 GPUs
Batch size per GPU: 32 (Total effective: ~128 with gradient accumulation)
Max epochs: 50 (with early stopping)
Data workers: 16 per DataLoader
Preprocessing workers: 32
[rank: 0] Global seed set to 42
/gpfs/home2/scur2746/recformer_env/lib/python3.10/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LongformerTokenizer'. 
The class this function is called from is 'RecformerTokenizer'.
Namespace(pretrain_ckpt='pretrained_models/recformer_seqrec_ckpt.bin', data_path='finetune_data/Scientific', output_dir='checkpoints', ckpt='best_model.bin', model_name_or_path='allenai/longformer-base-4096', train_file='train.json', dev_file='val.json', test_file='test.json', item2id_file='smap.json', meta_file='meta_data.json', preprocessing_num_workers=32, dataloader_num_workers=16, temp=0.05, num_train_epochs=50, gradient_accumulation_steps=2, finetune_negative_sample_size=-1, metric_ks=[10, 50], batch_size=32, learning_rate=5e-05, weight_decay=0, warmup_steps=100, device=0, fp16=True, fix_word_embedding=False, verbose=1, min_inter=10, multi_gpu=True, gpu_ids='0,1,2,3', pin_memory=True, cache_item_embeddings=True)
Using multi-GPU training on GPUs: [0, 1, 2, 3]
Before min_inter=10, users count: train=11041, val=11039, test=11039
After min_inter=10, users count: train=783, val=783, test=783
Tokenize all items...
/gpfs/home2/scur2746/recformer_toy/RecFormer/python_scripts/finetune_optimized.py:335: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Using 32 workers with chunksize 20 for tokenization.
Amazon dataset detected, using RecformerTrainDataset and RecformerEvalDataset.
Model wrapped with DataParallel using GPUs: [0, 1, 2, 3]
[Item Embeddings] Use cache: finetune_data/Scientific/preprocess/item_embeddings_Scientific
Initalize item embeddings from vectors.
Evaluate:   0%|                                                              | 0/25 [00:00<?, ?it/s]/gpfs/home2/scur2746/recformer_env/lib/python3.10/site-packages/transformers/modeling_utils.py:862: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
Evaluate:   4%|██▏                                                   | 1/25 [00:03<01:21,  3.39s/it]Evaluate:   8%|████▎                                                 | 2/25 [00:03<00:35,  1.55s/it]Evaluate:  12%|██████▍                                               | 3/25 [00:04<00:22,  1.03s/it]Evaluate:  16%|████████▋                                             | 4/25 [00:04<00:15,  1.38it/s]Evaluate:  20%|██████████▊                                           | 5/25 [00:04<00:11,  1.80it/s]Evaluate:  24%|████████████▉                                         | 6/25 [00:04<00:08,  2.24it/s]Evaluate:  28%|███████████████                                       | 7/25 [00:05<00:06,  2.62it/s]Evaluate:  32%|█████████████████▎                                    | 8/25 [00:05<00:05,  2.94it/s]Evaluate:  36%|███████████████████▍                                  | 9/25 [00:05<00:05,  3.19it/s]Evaluate:  40%|█████████████████████▏                               | 10/25 [00:05<00:04,  3.40it/s]Evaluate:  44%|███████████████████████▎                             | 11/25 [00:06<00:03,  3.54it/s]Evaluate:  48%|█████████████████████████▍                           | 12/25 [00:06<00:03,  3.70it/s]Evaluate:  52%|███████████████████████████▌                         | 13/25 [00:06<00:03,  3.83it/s]Evaluate:  56%|█████████████████████████████▋                       | 14/25 [00:06<00:02,  3.88it/s]Evaluate:  60%|███████████████████████████████▊                     | 15/25 [00:07<00:02,  3.90it/s]Evaluate:  64%|█████████████████████████████████▉                   | 16/25 [00:07<00:02,  3.94it/s]Evaluate:  68%|████████████████████████████████████                 | 17/25 [00:07<00:02,  3.96it/s]Evaluate:  72%|██████████████████████████████████████▏              | 18/25 [00:07<00:01,  3.97it/s]Evaluate:  76%|████████████████████████████████████████▎            | 19/25 [00:08<00:01,  3.98it/s]Evaluate:  80%|██████████████████████████████████████████▍          | 20/25 [00:08<00:01,  3.96it/s]Evaluate:  84%|████████████████████████████████████████████▌        | 21/25 [00:08<00:01,  3.98it/s]Evaluate:  88%|██████████████████████████████████████████████▋      | 22/25 [00:08<00:00,  3.98it/s]Evaluate:  92%|████████████████████████████████████████████████▊    | 23/25 [00:09<00:00,  3.95it/s]Evaluate:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:09<00:00,  3.98it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:09<00:00,  3.93it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:09<00:00,  2.60it/s]
Initial Test set: {'NDCG@10': 0.040317683033645156, 'Recall@10': 0.06016666680574417, 'NDCG@50': 0.05819808384403587, 'Recall@50': 0.1419166672229767, 'MRR': 0.04007706178352237, 'AUC': 0.7306678080558777}

=== Starting Training ===
Total epochs: 50
Batch size: 32
Gradient accumulation steps: 2
Effective batch size: 64

=== Stage 1: Initial Training (patience=5) ===

Epoch 1/50
Re-encoding items...
Encode all items:   0%|                                                     | 0/167 [00:00<?, ?it/s]Encode all items:   1%|▌                                            | 2/167 [00:00<00:08, 19.76it/s]Encode all items:   3%|█▎                                           | 5/167 [00:00<00:07, 21.82it/s]Encode all items:   5%|██▏                                          | 8/167 [00:00<00:07, 22.34it/s]Encode all items:   7%|██▉                                         | 11/167 [00:00<00:07, 22.06it/s]Encode all items:   8%|███▋                                        | 14/167 [00:00<00:06, 22.36it/s]Encode all items:  10%|████▍                                       | 17/167 [00:00<00:06, 22.98it/s]Encode all items:  12%|█████▎                                      | 20/167 [00:00<00:06, 22.96it/s]Encode all items:  14%|██████                                      | 23/167 [00:01<00:06, 23.37it/s]Encode all items:  16%|██████▊                                     | 26/167 [00:01<00:06, 23.23it/s]Encode all items:  17%|███████▋                                    | 29/167 [00:01<00:05, 23.98it/s]Encode all items:  19%|████████▍                                   | 32/167 [00:01<00:05, 24.07it/s]Encode all items:  21%|█████████▏                                  | 35/167 [00:01<00:05, 24.14it/s]Encode all items:  23%|██████████                                  | 38/167 [00:01<00:05, 23.76it/s]Encode all items:  25%|██████████▊                                 | 41/167 [00:01<00:05, 23.92it/s]Encode all items:  26%|███████████▌                                | 44/167 [00:01<00:05, 24.03it/s]Encode all items:  28%|████████████▍                               | 47/167 [00:02<00:04, 24.13it/s]Encode all items:  30%|█████████████▏                              | 50/167 [00:02<00:04, 24.61it/s]Encode all items:  32%|█████████████▉                              | 53/167 [00:02<00:04, 23.66it/s]Encode all items:  34%|██████████████▊                             | 56/167 [00:02<00:04, 23.83it/s]Encode all items:  35%|███████████████▌                            | 59/167 [00:02<00:04, 23.15it/s]Encode all items:  37%|████████████████▎                           | 62/167 [00:02<00:04, 23.41it/s]Encode all items:  39%|█████████████████▏                          | 65/167 [00:02<00:04, 24.10it/s]Encode all items:  41%|█████████████████▉                          | 68/167 [00:02<00:04, 23.72it/s]Encode all items:  43%|██████████████████▋                         | 71/167 [00:03<00:04, 23.08it/s]Encode all items:  44%|███████████████████▍                        | 74/167 [00:03<00:04, 22.65it/s]Encode all items:  46%|████████████████████▎                       | 77/167 [00:03<00:04, 22.36it/s]Encode all items:  48%|█████████████████████                       | 80/167 [00:03<00:03, 22.53it/s]Encode all items:  50%|█████████████████████▊                      | 83/167 [00:03<00:03, 23.03it/s]Encode all items:  51%|██████████████████████▋                     | 86/167 [00:03<00:03, 22.54it/s]Encode all items:  53%|███████████████████████▍                    | 89/167 [00:03<00:03, 23.45it/s]Encode all items:  55%|████████████████████████▏                   | 92/167 [00:03<00:03, 23.23it/s]Encode all items:  57%|█████████████████████████                   | 95/167 [00:04<00:03, 23.54it/s]Encode all items:  59%|█████████████████████████▊                  | 98/167 [00:04<00:02, 24.20it/s]Encode all items:  60%|██████████████████████████                 | 101/167 [00:04<00:02, 23.60it/s]Encode all items:  62%|██████████████████████████▊                | 104/167 [00:04<00:02, 23.82it/s]Encode all items:  64%|███████████████████████████▌               | 107/167 [00:04<00:02, 23.55it/s]Encode all items:  66%|████████████████████████████▎              | 110/167 [00:04<00:02, 23.28it/s]Encode all items:  68%|█████████████████████████████              | 113/167 [00:04<00:02, 23.10it/s]Encode all items:  69%|█████████████████████████████▊             | 116/167 [00:04<00:02, 23.39it/s]Encode all items:  71%|██████████████████████████████▋            | 119/167 [00:05<00:02, 23.60it/s]Encode all items:  73%|███████████████████████████████▍           | 122/167 [00:05<00:01, 23.80it/s]Encode all items:  75%|████████████████████████████████▏          | 125/167 [00:05<00:01, 23.89it/s]Encode all items:  77%|████████████████████████████████▉          | 128/167 [00:05<00:01, 23.51it/s]Encode all items:  78%|█████████████████████████████████▋         | 131/167 [00:05<00:01, 23.27it/s]Encode all items:  80%|██████████████████████████████████▌        | 134/167 [00:05<00:01, 23.20it/s]Encode all items:  82%|███████████████████████████████████▎       | 137/167 [00:05<00:01, 23.93it/s]Encode all items:  84%|████████████████████████████████████       | 140/167 [00:05<00:01, 23.04it/s]Encode all items:  86%|████████████████████████████████████▊      | 143/167 [00:06<00:01, 22.93it/s]Encode all items:  87%|█████████████████████████████████████▌     | 146/167 [00:06<00:00, 22.93it/s]Encode all items:  89%|██████████████████████████████████████▎    | 149/167 [00:06<00:00, 22.81it/s]Encode all items:  91%|███████████████████████████████████████▏   | 152/167 [00:06<00:00, 22.78it/s]Encode all items:  93%|███████████████████████████████████████▉   | 155/167 [00:06<00:00, 22.75it/s]Encode all items:  95%|████████████████████████████████████████▋  | 158/167 [00:06<00:00, 22.99it/s]Encode all items:  96%|█████████████████████████████████████████▍ | 161/167 [00:06<00:00, 23.29it/s]Encode all items:  98%|██████████████████████████████████████████▏| 164/167 [00:07<00:00, 23.98it/s]Encode all items: 100%|███████████████████████████████████████████| 167/167 [00:07<00:00, 24.03it/s]Encode all items: 100%|███████████████████████████████████████████| 167/167 [00:07<00:00, 23.37it/s]
Initalize item embeddings from vectors.
Training:   0%|                                                              | 0/25 [00:00<?, ?it/s]/gpfs/home2/scur2746/recformer_toy/RecFormer/python_scripts/finetune_optimized.py:116: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/gpfs/home2/scur2746/recformer_env/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
Training:   4%|██▏                                                   | 1/25 [00:01<00:30,  1.29s/it]Training:   8%|████▎                                                 | 2/25 [00:01<00:17,  1.32it/s]Training:  12%|██████▍                                               | 3/25 [00:01<00:12,  1.82it/s]Training:  16%|████████▋                                             | 4/25 [00:02<00:09,  2.11it/s]Training:  20%|██████████▊                                           | 5/25 [00:02<00:08,  2.44it/s]Training:  24%|████████████▉                                         | 6/25 [00:02<00:07,  2.64it/s]Training:  28%|███████████████                                       | 7/25 [00:03<00:06,  2.87it/s]Training:  32%|█████████████████▎                                    | 8/25 [00:03<00:05,  3.02it/s]Training:  36%|███████████████████▍                                  | 9/25 [00:03<00:05,  3.17it/s]Training:  40%|█████████████████████▏                               | 10/25 [00:04<00:04,  3.23it/s]Training:  44%|███████████████████████▎                             | 11/25 [00:04<00:04,  3.31it/s]Training:  48%|█████████████████████████▍                           | 12/25 [00:04<00:03,  3.35it/s]Training:  52%|███████████████████████████▌                         | 13/25 [00:04<00:03,  3.40it/s]Training:  56%|█████████████████████████████▋                       | 14/25 [00:05<00:03,  2.90it/s]Training:  60%|███████████████████████████████▊                     | 15/25 [00:05<00:03,  3.02it/s]Training:  64%|█████████████████████████████████▉                   | 16/25 [00:06<00:02,  3.12it/s]Training:  68%|████████████████████████████████████                 | 17/25 [00:06<00:02,  3.22it/s]Training:  72%|██████████████████████████████████████▏              | 18/25 [00:06<00:02,  3.28it/s]Training:  76%|████████████████████████████████████████▎            | 19/25 [00:06<00:01,  3.35it/s]Training:  80%|██████████████████████████████████████████▍          | 20/25 [00:07<00:01,  3.36it/s]Training:  84%|████████████████████████████████████████████▌        | 21/25 [00:07<00:01,  3.40it/s]Training:  88%|██████████████████████████████████████████████▋      | 22/25 [00:07<00:00,  3.37it/s]Training:  92%|████████████████████████████████████████████████▊    | 23/25 [00:08<00:00,  3.41it/s]Training:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:08<00:00,  3.37it/s]Training: 100%|█████████████████████████████████████████████████████| 25/25 [00:08<00:00,  3.33it/s]Training: 100%|█████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.85it/s]
Evaluate:   0%|                                                              | 0/25 [00:00<?, ?it/s]Evaluate:   4%|██▏                                                   | 1/25 [00:00<00:20,  1.20it/s]Evaluate:   8%|████▎                                                 | 2/25 [00:01<00:11,  2.03it/s]Evaluate:  12%|██████▍                                               | 3/25 [00:01<00:08,  2.60it/s]Evaluate:  16%|████████▋                                             | 4/25 [00:01<00:06,  3.00it/s]Evaluate:  20%|██████████▊                                           | 5/25 [00:01<00:05,  3.34it/s]Evaluate:  24%|████████████▉                                         | 6/25 [00:02<00:05,  3.53it/s]Evaluate:  28%|███████████████                                       | 7/25 [00:02<00:04,  3.65it/s]Evaluate:  32%|█████████████████▎                                    | 8/25 [00:02<00:04,  3.73it/s]Evaluate:  36%|███████████████████▍                                  | 9/25 [00:02<00:04,  3.84it/s]Evaluate:  40%|█████████████████████▏                               | 10/25 [00:03<00:03,  3.87it/s]Evaluate:  44%|███████████████████████▎                             | 11/25 [00:03<00:03,  3.93it/s]Evaluate:  48%|█████████████████████████▍                           | 12/25 [00:03<00:03,  3.93it/s]Evaluate:  52%|███████████████████████████▌                         | 13/25 [00:03<00:03,  3.94it/s]Evaluate:  56%|█████████████████████████████▋                       | 14/25 [00:04<00:02,  3.98it/s]Evaluate:  60%|███████████████████████████████▊                     | 15/25 [00:04<00:02,  3.98it/s]Evaluate:  64%|█████████████████████████████████▉                   | 16/25 [00:04<00:02,  3.99it/s]Evaluate:  68%|████████████████████████████████████                 | 17/25 [00:04<00:02,  3.98it/s]Evaluate:  72%|██████████████████████████████████████▏              | 18/25 [00:05<00:01,  3.95it/s]Evaluate:  76%|████████████████████████████████████████▎            | 19/25 [00:05<00:01,  3.93it/s]Evaluate:  80%|██████████████████████████████████████████▍          | 20/25 [00:05<00:01,  3.96it/s]Evaluate:  84%|████████████████████████████████████████████▌        | 21/25 [00:05<00:01,  3.96it/s]Evaluate:  88%|██████████████████████████████████████████████▋      | 22/25 [00:06<00:00,  3.96it/s]Evaluate:  92%|████████████████████████████████████████████████▊    | 23/25 [00:06<00:00,  3.98it/s]Evaluate:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:06<00:00,  3.98it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:06<00:00,  3.95it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:06<00:00,  3.58it/s]
Epoch: 1. Dev set: {'NDCG@10': 0.06459494795650243, 'Recall@10': 0.11083333373069763, 'NDCG@50': 0.0838429943099618, 'Recall@50': 0.19900000095367432, 'MRR': 0.05617438664659858, 'AUC': 0.7538264346122742}
Save the best model.

Epoch 2/50
Training:   0%|                                                              | 0/25 [00:00<?, ?it/s]Training:   4%|██▏                                                   | 1/25 [00:00<00:21,  1.12it/s]Training:   8%|████▎                                                 | 2/25 [00:01<00:12,  1.82it/s]Training:  12%|██████▍                                               | 3/25 [00:01<00:11,  2.00it/s]Training:  16%|████████▋                                             | 4/25 [00:01<00:08,  2.37it/s]Training:  20%|██████████▊                                           | 5/25 [00:02<00:07,  2.65it/s]Training:  24%|████████████▉                                         | 6/25 [00:02<00:06,  2.83it/s]Training:  28%|███████████████                                       | 7/25 [00:02<00:06,  3.00it/s]Training:  32%|█████████████████▎                                    | 8/25 [00:03<00:05,  3.08it/s]Training:  36%|███████████████████▍                                  | 9/25 [00:03<00:05,  3.19it/s]Training:  40%|█████████████████████▏                               | 10/25 [00:03<00:04,  3.23it/s]Training:  44%|███████████████████████▎                             | 11/25 [00:04<00:04,  3.30it/s]Training:  48%|█████████████████████████▍                           | 12/25 [00:04<00:03,  3.29it/s]Training:  52%|███████████████████████████▌                         | 13/25 [00:04<00:03,  3.33it/s]Training:  56%|█████████████████████████████▋                       | 14/25 [00:04<00:03,  3.32it/s]Training:  60%|███████████████████████████████▊                     | 15/25 [00:05<00:02,  3.35it/s]Training:  64%|█████████████████████████████████▉                   | 16/25 [00:05<00:02,  3.33it/s]Training:  68%|████████████████████████████████████                 | 17/25 [00:05<00:02,  3.37it/s]Training:  72%|██████████████████████████████████████▏              | 18/25 [00:06<00:02,  3.35it/s]Training:  76%|████████████████████████████████████████▎            | 19/25 [00:06<00:01,  3.38it/s]Training:  80%|██████████████████████████████████████████▍          | 20/25 [00:06<00:01,  3.36it/s]Training:  84%|████████████████████████████████████████████▌        | 21/25 [00:07<00:01,  3.37it/s]Training:  88%|██████████████████████████████████████████████▋      | 22/25 [00:07<00:00,  3.38it/s]Training:  92%|████████████████████████████████████████████████▊    | 23/25 [00:07<00:00,  3.41it/s]Training:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:07<00:00,  3.40it/s]Training: 100%|█████████████████████████████████████████████████████| 25/25 [00:08<00:00,  3.32it/s]Training: 100%|█████████████████████████████████████████████████████| 25/25 [00:08<00:00,  3.00it/s]
Evaluate:   0%|                                                              | 0/25 [00:00<?, ?it/s]Evaluate:   4%|██▏                                                   | 1/25 [00:00<00:20,  1.16it/s]Evaluate:   8%|████▎                                                 | 2/25 [00:01<00:11,  1.98it/s]Evaluate:  12%|██████▍                                               | 3/25 [00:01<00:08,  2.57it/s]Evaluate:  16%|████████▋                                             | 4/25 [00:01<00:07,  3.00it/s]Evaluate:  20%|██████████▊                                           | 5/25 [00:01<00:06,  3.29it/s]Evaluate:  24%|████████████▉                                         | 6/25 [00:02<00:05,  3.53it/s]Evaluate:  28%|███████████████                                       | 7/25 [00:02<00:04,  3.70it/s]Evaluate:  32%|█████████████████▎                                    | 8/25 [00:02<00:04,  3.78it/s]Evaluate:  36%|███████████████████▍                                  | 9/25 [00:02<00:04,  3.88it/s]Evaluate:  40%|█████████████████████▏                               | 10/25 [00:03<00:03,  3.91it/s]Evaluate:  44%|███████████████████████▎                             | 11/25 [00:03<00:04,  3.33it/s]Evaluate:  48%|█████████████████████████▍                           | 12/25 [00:03<00:03,  3.50it/s]Evaluate:  52%|███████████████████████████▌                         | 13/25 [00:04<00:03,  3.62it/s]Evaluate:  56%|█████████████████████████████▋                       | 14/25 [00:04<00:02,  3.71it/s]Evaluate:  60%|███████████████████████████████▊                     | 15/25 [00:04<00:02,  3.78it/s]Evaluate:  64%|█████████████████████████████████▉                   | 16/25 [00:04<00:02,  3.83it/s]Evaluate:  68%|████████████████████████████████████                 | 17/25 [00:05<00:02,  3.88it/s]Evaluate:  72%|██████████████████████████████████████▏              | 18/25 [00:05<00:01,  3.90it/s]Evaluate:  76%|████████████████████████████████████████▎            | 19/25 [00:05<00:01,  3.93it/s]Evaluate:  80%|██████████████████████████████████████████▍          | 20/25 [00:05<00:01,  3.94it/s]Evaluate:  84%|████████████████████████████████████████████▌        | 21/25 [00:06<00:01,  3.97it/s]Evaluate:  88%|██████████████████████████████████████████████▋      | 22/25 [00:06<00:00,  3.95it/s]Evaluate:  92%|████████████████████████████████████████████████▊    | 23/25 [00:06<00:00,  3.95it/s]Evaluate:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:06<00:00,  3.94it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:07<00:00,  3.92it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:07<00:00,  3.48it/s]
Epoch: 2. Dev set: {'NDCG@10': 0.06940032847225666, 'Recall@10': 0.11566666722297668, 'NDCG@50': 0.08624104268848896, 'Recall@50': 0.1940000009536743, 'MRR': 0.06036996697541326, 'AUC': 0.7533811378479004}
Save the best model.

Epoch 3/50
Training:   0%|                                                              | 0/25 [00:00<?, ?it/s]Training:   4%|██▏                                                   | 1/25 [00:00<00:21,  1.13it/s]Training:   8%|████▎                                                 | 2/25 [00:01<00:12,  1.83it/s]Training:  12%|██████▍                                               | 3/25 [00:01<00:09,  2.33it/s]Training:  16%|████████▋                                             | 4/25 [00:01<00:07,  2.65it/s]Training:  20%|██████████▊                                           | 5/25 [00:02<00:06,  2.89it/s]Training:  24%|████████████▉                                         | 6/25 [00:02<00:06,  2.94it/s]Training:  28%|███████████████                                       | 7/25 [00:02<00:05,  3.13it/s]Training:  32%|█████████████████▎                                    | 8/25 [00:02<00:05,  3.18it/s]Training:  36%|███████████████████▍                                  | 9/25 [00:03<00:04,  3.26it/s]Training:  40%|█████████████████████▏                               | 10/25 [00:03<00:04,  3.31it/s]Training:  44%|███████████████████████▎                             | 11/25 [00:03<00:04,  3.40it/s]Training:  48%|█████████████████████████▍                           | 12/25 [00:04<00:03,  3.36it/s]Training:  52%|███████████████████████████▌                         | 13/25 [00:04<00:03,  3.38it/s]Training:  56%|█████████████████████████████▋                       | 14/25 [00:04<00:03,  3.37it/s]Training:  60%|███████████████████████████████▊                     | 15/25 [00:05<00:02,  3.38it/s]Training:  64%|█████████████████████████████████▉                   | 16/25 [00:05<00:02,  3.37it/s]Training:  68%|████████████████████████████████████                 | 17/25 [00:05<00:02,  3.38it/s]Training:  72%|██████████████████████████████████████▏              | 18/25 [00:05<00:02,  3.34it/s]Training:  76%|████████████████████████████████████████▎            | 19/25 [00:06<00:01,  3.39it/s]Training:  80%|██████████████████████████████████████████▍          | 20/25 [00:06<00:01,  3.36it/s]Training:  84%|████████████████████████████████████████████▌        | 21/25 [00:06<00:01,  3.38it/s]Training:  88%|██████████████████████████████████████████████▋      | 22/25 [00:07<00:00,  3.38it/s]Training:  92%|████████████████████████████████████████████████▊    | 23/25 [00:07<00:00,  2.93it/s]Training:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:07<00:00,  3.03it/s]Training: 100%|█████████████████████████████████████████████████████| 25/25 [00:08<00:00,  3.02it/s]Training: 100%|█████████████████████████████████████████████████████| 25/25 [00:08<00:00,  3.01it/s]
Evaluate:   0%|                                                              | 0/25 [00:00<?, ?it/s]Evaluate:   4%|██▏                                                   | 1/25 [00:00<00:20,  1.17it/s]Evaluate:   8%|████▎                                                 | 2/25 [00:01<00:11,  1.99it/s]Evaluate:  12%|██████▍                                               | 3/25 [00:01<00:08,  2.58it/s]Evaluate:  16%|████████▋                                             | 4/25 [00:01<00:07,  2.98it/s]Evaluate:  20%|██████████▊                                           | 5/25 [00:01<00:06,  3.26it/s]Evaluate:  24%|████████████▉                                         | 6/25 [00:02<00:05,  3.49it/s]Evaluate:  28%|███████████████                                       | 7/25 [00:02<00:04,  3.65it/s]Evaluate:  32%|█████████████████▎                                    | 8/25 [00:02<00:04,  3.76it/s]Evaluate:  36%|███████████████████▍                                  | 9/25 [00:02<00:04,  3.83it/s]Evaluate:  40%|█████████████████████▏                               | 10/25 [00:03<00:03,  3.86it/s]Evaluate:  44%|███████████████████████▎                             | 11/25 [00:03<00:03,  3.90it/s]Evaluate:  48%|█████████████████████████▍                           | 12/25 [00:03<00:03,  3.92it/s]Evaluate:  52%|███████████████████████████▌                         | 13/25 [00:03<00:03,  3.93it/s]Evaluate:  56%|█████████████████████████████▋                       | 14/25 [00:04<00:02,  4.01it/s]Evaluate:  60%|███████████████████████████████▊                     | 15/25 [00:04<00:02,  4.00it/s]Evaluate:  64%|█████████████████████████████████▉                   | 16/25 [00:04<00:02,  3.97it/s]Evaluate:  68%|████████████████████████████████████                 | 17/25 [00:04<00:02,  3.97it/s]Evaluate:  72%|██████████████████████████████████████▏              | 18/25 [00:05<00:01,  3.96it/s]Evaluate:  76%|████████████████████████████████████████▎            | 19/25 [00:05<00:01,  3.96it/s]Evaluate:  80%|██████████████████████████████████████████▍          | 20/25 [00:05<00:01,  3.98it/s]Evaluate:  84%|████████████████████████████████████████████▌        | 21/25 [00:05<00:01,  3.98it/s]Evaluate:  88%|██████████████████████████████████████████████▋      | 22/25 [00:06<00:00,  4.00it/s]Evaluate:  92%|████████████████████████████████████████████████▊    | 23/25 [00:06<00:00,  4.01it/s]Evaluate:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:06<00:00,  4.00it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:06<00:00,  3.94it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:06<00:00,  3.57it/s]
Epoch: 3. Dev set: {'NDCG@10': 0.06544984146952629, 'Recall@10': 0.11958333373069763, 'NDCG@50': 0.08173030823469161, 'Recall@50': 0.19633333444595336, 'MRR': 0.053759804680012166, 'AUC': 0.7584151005744935}
No improvement. Patience: 4/5

Epoch 4/50
Training:   0%|                                                              | 0/25 [00:00<?, ?it/s]Training:   4%|██▏                                                   | 1/25 [00:00<00:21,  1.09it/s]Training:   8%|████▎                                                 | 2/25 [00:01<00:12,  1.78it/s]Training:  12%|██████▍                                               | 3/25 [00:01<00:09,  2.28it/s]Training:  16%|████████▋                                             | 4/25 [00:01<00:08,  2.59it/s]Training:  20%|██████████▊                                           | 5/25 [00:02<00:07,  2.83it/s]Training:  24%|████████████▉                                         | 6/25 [00:02<00:06,  2.96it/s]Training:  28%|███████████████                                       | 7/25 [00:02<00:05,  3.08it/s]Training:  32%|█████████████████▎                                    | 8/25 [00:03<00:05,  3.13it/s]Training:  36%|███████████████████▍                                  | 9/25 [00:03<00:04,  3.24it/s]Training:  40%|█████████████████████▏                               | 10/25 [00:03<00:05,  2.83it/s]Training:  44%|███████████████████████▎                             | 11/25 [00:04<00:04,  2.98it/s]Training:  48%|█████████████████████████▍                           | 12/25 [00:04<00:04,  3.08it/s]Training:  52%|███████████████████████████▌                         | 13/25 [00:04<00:03,  3.17it/s]Training:  56%|█████████████████████████████▋                       | 14/25 [00:04<00:03,  3.20it/s]Training:  60%|███████████████████████████████▊                     | 15/25 [00:05<00:03,  3.25it/s]Training:  64%|█████████████████████████████████▉                   | 16/25 [00:05<00:02,  3.25it/s]Training:  68%|████████████████████████████████████                 | 17/25 [00:05<00:02,  3.29it/s]Training:  72%|██████████████████████████████████████▏              | 18/25 [00:06<00:02,  3.28it/s]Training:  76%|████████████████████████████████████████▎            | 19/25 [00:06<00:01,  3.38it/s]Training:  80%|██████████████████████████████████████████▍          | 20/25 [00:06<00:01,  3.39it/s]Training:  84%|████████████████████████████████████████████▌        | 21/25 [00:07<00:01,  3.40it/s]Training:  88%|██████████████████████████████████████████████▋      | 22/25 [00:07<00:00,  3.36it/s]Training:  92%|████████████████████████████████████████████████▊    | 23/25 [00:07<00:00,  3.35it/s]Training:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:07<00:00,  3.32it/s]Training: 100%|█████████████████████████████████████████████████████| 25/25 [00:08<00:00,  3.25it/s]Training: 100%|█████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.98it/s]
Evaluate:   0%|                                                              | 0/25 [00:00<?, ?it/s]Evaluate:   4%|██▏                                                   | 1/25 [00:00<00:20,  1.17it/s]Evaluate:   8%|████▎                                                 | 2/25 [00:01<00:11,  2.00it/s]Evaluate:  12%|██████▍                                               | 3/25 [00:01<00:08,  2.58it/s]Evaluate:  16%|████████▋                                             | 4/25 [00:01<00:06,  3.01it/s]Evaluate:  20%|██████████▊                                           | 5/25 [00:01<00:05,  3.34it/s]Evaluate:  24%|████████████▉                                         | 6/25 [00:02<00:05,  3.53it/s]Evaluate:  28%|███████████████                                       | 7/25 [00:02<00:04,  3.64it/s]Evaluate:  32%|█████████████████▎                                    | 8/25 [00:02<00:04,  3.74it/s]Evaluate:  36%|███████████████████▍                                  | 9/25 [00:02<00:04,  3.84it/s]Evaluate:  40%|█████████████████████▏                               | 10/25 [00:03<00:03,  3.86it/s]Evaluate:  44%|███████████████████████▎                             | 11/25 [00:03<00:03,  3.89it/s]Evaluate:  48%|█████████████████████████▍                           | 12/25 [00:03<00:03,  3.90it/s]Evaluate:  52%|███████████████████████████▌                         | 13/25 [00:03<00:03,  3.93it/s]Evaluate:  56%|█████████████████████████████▋                       | 14/25 [00:04<00:02,  3.96it/s]Evaluate:  60%|███████████████████████████████▊                     | 15/25 [00:04<00:02,  3.97it/s]Evaluate:  64%|█████████████████████████████████▉                   | 16/25 [00:04<00:02,  4.00it/s]Evaluate:  68%|████████████████████████████████████                 | 17/25 [00:04<00:02,  3.99it/s]Evaluate:  72%|██████████████████████████████████████▏              | 18/25 [00:05<00:01,  3.97it/s]Evaluate:  76%|████████████████████████████████████████▎            | 19/25 [00:05<00:01,  3.96it/s]Evaluate:  80%|██████████████████████████████████████████▍          | 20/25 [00:05<00:01,  3.94it/s]Evaluate:  84%|████████████████████████████████████████████▌        | 21/25 [00:05<00:01,  3.95it/s]Evaluate:  88%|██████████████████████████████████████████████▋      | 22/25 [00:06<00:00,  3.94it/s]Evaluate:  92%|████████████████████████████████████████████████▊    | 23/25 [00:06<00:00,  3.96it/s]Evaluate:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:06<00:00,  3.38it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:07<00:00,  3.50it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:07<00:00,  3.50it/s]
Epoch: 4. Dev set: {'NDCG@10': 0.057689680755138396, 'Recall@10': 0.10691666722297669, 'NDCG@50': 0.07409266360104085, 'Recall@50': 0.18258333444595337, 'MRR': 0.04787692230194807, 'AUC': 0.75964031457901}
No improvement. Patience: 3/5

Epoch 5/50
Training:   0%|                                                              | 0/25 [00:00<?, ?it/s]Training:   4%|██▏                                                   | 1/25 [00:00<00:21,  1.10it/s]Training:   8%|████▎                                                 | 2/25 [00:01<00:12,  1.80it/s]Training:  12%|██████▍                                               | 3/25 [00:01<00:09,  2.30it/s]Training:  16%|████████▋                                             | 4/25 [00:01<00:07,  2.63it/s]Training:  20%|██████████▊                                           | 5/25 [00:02<00:06,  2.86it/s]Training:  24%|████████████▉                                         | 6/25 [00:02<00:06,  2.99it/s]Training:  28%|███████████████                                       | 7/25 [00:02<00:05,  3.11it/s]Training:  32%|█████████████████▎                                    | 8/25 [00:02<00:05,  3.21it/s]Training:  36%|███████████████████▍                                  | 9/25 [00:03<00:04,  3.27it/s]Training:  40%|█████████████████████▏                               | 10/25 [00:03<00:04,  3.27it/s]Training:  44%|███████████████████████▎                             | 11/25 [00:03<00:04,  3.32it/s]Training:  48%|█████████████████████████▍                           | 12/25 [00:04<00:03,  3.31it/s]Training:  52%|███████████████████████████▌                         | 13/25 [00:04<00:03,  3.35it/s]Training:  56%|█████████████████████████████▋                       | 14/25 [00:04<00:03,  3.32it/s]Training:  60%|███████████████████████████████▊                     | 15/25 [00:05<00:02,  3.34it/s]Training:  64%|█████████████████████████████████▉                   | 16/25 [00:05<00:02,  3.31it/s]Training:  68%|████████████████████████████████████                 | 17/25 [00:05<00:02,  3.33it/s]Training:  72%|██████████████████████████████████████▏              | 18/25 [00:05<00:02,  3.30it/s]Training:  76%|████████████████████████████████████████▎            | 19/25 [00:06<00:01,  3.33it/s]Training:  80%|██████████████████████████████████████████▍          | 20/25 [00:06<00:01,  3.30it/s]Training:  84%|████████████████████████████████████████████▌        | 21/25 [00:06<00:01,  3.33it/s]Training:  88%|██████████████████████████████████████████████▋      | 22/25 [00:07<00:00,  3.32it/s]Training:  92%|████████████████████████████████████████████████▊    | 23/25 [00:07<00:00,  3.32it/s]Training:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:07<00:00,  3.34it/s]Training: 100%|█████████████████████████████████████████████████████| 25/25 [00:08<00:00,  3.37it/s]Training: 100%|█████████████████████████████████████████████████████| 25/25 [00:08<00:00,  3.05it/s]
Evaluate:   0%|                                                              | 0/25 [00:00<?, ?it/s]Evaluate:   4%|██▏                                                   | 1/25 [00:01<00:24,  1.02s/it]Evaluate:   8%|████▎                                                 | 2/25 [00:01<00:13,  1.76it/s]Evaluate:  12%|██████▍                                               | 3/25 [00:01<00:09,  2.36it/s]Evaluate:  16%|████████▋                                             | 4/25 [00:01<00:07,  2.82it/s]Evaluate:  20%|██████████▊                                           | 5/25 [00:02<00:06,  3.14it/s]Evaluate:  24%|████████████▉                                         | 6/25 [00:02<00:05,  3.38it/s]Evaluate:  28%|███████████████                                       | 7/25 [00:02<00:05,  3.60it/s]Evaluate:  32%|█████████████████▎                                    | 8/25 [00:02<00:04,  3.74it/s]Evaluate:  36%|███████████████████▍                                  | 9/25 [00:03<00:04,  3.81it/s]Evaluate:  40%|█████████████████████▏                               | 10/25 [00:03<00:03,  3.87it/s]Evaluate:  44%|███████████████████████▎                             | 11/25 [00:03<00:03,  3.90it/s]Evaluate:  48%|█████████████████████████▍                           | 12/25 [00:03<00:03,  3.92it/s]Evaluate:  52%|███████████████████████████▌                         | 13/25 [00:04<00:02,  4.02it/s]Evaluate:  56%|█████████████████████████████▋                       | 14/25 [00:04<00:02,  4.06it/s]Evaluate:  60%|███████████████████████████████▊                     | 15/25 [00:04<00:02,  4.04it/s]Evaluate:  64%|█████████████████████████████████▉                   | 16/25 [00:04<00:02,  4.01it/s]Evaluate:  68%|████████████████████████████████████                 | 17/25 [00:05<00:02,  3.99it/s]Evaluate:  72%|██████████████████████████████████████▏              | 18/25 [00:05<00:01,  3.96it/s]Evaluate:  76%|████████████████████████████████████████▎            | 19/25 [00:05<00:01,  3.95it/s]Evaluate:  80%|██████████████████████████████████████████▍          | 20/25 [00:05<00:01,  3.95it/s]Evaluate:  84%|████████████████████████████████████████████▌        | 21/25 [00:06<00:01,  3.94it/s]Evaluate:  88%|██████████████████████████████████████████████▋      | 22/25 [00:06<00:00,  3.92it/s]Evaluate:  92%|████████████████████████████████████████████████▊    | 23/25 [00:06<00:00,  4.04it/s]Evaluate:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:06<00:00,  4.10it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:06<00:00,  4.25it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:07<00:00,  3.53it/s]
Epoch: 5. Dev set: {'NDCG@10': 0.058241151347756384, 'Recall@10': 0.10441666722297668, 'NDCG@50': 0.0741839562356472, 'Recall@50': 0.17758333444595337, 'MRR': 0.049124031746760013, 'AUC': 0.7511732769012451}
No improvement. Patience: 2/5

Epoch 6/50
Re-encoding items...
Encode all items:   0%|                                                     | 0/167 [00:00<?, ?it/s]Encode all items:   2%|▊                                            | 3/167 [00:00<00:07, 22.43it/s]Encode all items:   4%|█▌                                           | 6/167 [00:00<00:07, 22.74it/s]Encode all items:   5%|██▍                                          | 9/167 [00:00<00:06, 22.82it/s]Encode all items:   7%|███▏                                        | 12/167 [00:00<00:06, 22.36it/s]Encode all items:   9%|███▉                                        | 15/167 [00:00<00:06, 22.57it/s]Encode all items:  11%|████▋                                       | 18/167 [00:00<00:06, 23.12it/s]Encode all items:  13%|█████▌                                      | 21/167 [00:00<00:06, 23.06it/s]Encode all items:  14%|██████▎                                     | 24/167 [00:01<00:06, 23.43it/s]Encode all items:  16%|███████                                     | 27/167 [00:01<00:05, 23.67it/s]Encode all items:  18%|███████▉                                    | 30/167 [00:01<00:05, 23.84it/s]Encode all items:  20%|████████▋                                   | 33/167 [00:01<00:05, 23.95it/s]Encode all items:  22%|█████████▍                                  | 36/167 [00:01<00:05, 24.03it/s]Encode all items:  23%|██████████▎                                 | 39/167 [00:01<00:05, 24.09it/s]Encode all items:  25%|███████████                                 | 42/167 [00:01<00:05, 23.70it/s]Encode all items:  27%|███████████▊                                | 45/167 [00:01<00:05, 24.18it/s]Encode all items:  29%|████████████▋                               | 48/167 [00:02<00:04, 24.18it/s]Encode all items:  31%|█████████████▍                              | 51/167 [00:02<00:04, 24.12it/s]Encode all items:  32%|██████████████▏                             | 54/167 [00:02<00:04, 23.65it/s]Encode all items:  34%|███████████████                             | 57/167 [00:02<00:04, 23.40it/s]Encode all items:  36%|███████████████▊                            | 60/167 [00:02<00:04, 23.11it/s]Encode all items:  38%|████████████████▌                           | 63/167 [00:02<00:04, 23.41it/s]Encode all items:  40%|█████████████████▍                          | 66/167 [00:02<00:04, 23.55it/s]Encode all items:  41%|██████████████████▏                         | 69/167 [00:02<00:04, 23.23it/s]Encode all items:  43%|██████████████████▉                         | 72/167 [00:03<00:04, 22.62it/s]Encode all items:  45%|███████████████████▊                        | 75/167 [00:03<00:04, 22.23it/s]Encode all items:  47%|████████████████████▌                       | 78/167 [00:03<00:04, 22.05it/s]Encode all items:  49%|█████████████████████▎                      | 81/167 [00:03<00:03, 22.22it/s]Encode all items:  50%|██████████████████████▏                     | 84/167 [00:03<00:03, 22.74it/s]Encode all items:  52%|██████████████████████▉                     | 87/167 [00:03<00:03, 22.77it/s]Encode all items:  54%|███████████████████████▋                    | 90/167 [00:03<00:03, 23.56it/s]Encode all items:  56%|████████████████████████▌                   | 93/167 [00:04<00:03, 22.96it/s]Encode all items:  57%|█████████████████████████▎                  | 96/167 [00:04<00:02, 23.71it/s]Encode all items:  59%|██████████████████████████                  | 99/167 [00:04<00:02, 24.26it/s]Encode all items:  61%|██████████████████████████▎                | 102/167 [00:04<00:02, 23.78it/s]Encode all items:  63%|███████████████████████████                | 105/167 [00:04<00:02, 23.48it/s]Encode all items:  65%|███████████████████████████▊               | 108/167 [00:04<00:02, 23.25it/s]Encode all items:  66%|████████████████████████████▌              | 111/167 [00:04<00:02, 23.11it/s]Encode all items:  68%|█████████████████████████████▎             | 114/167 [00:04<00:02, 23.41it/s]Encode all items:  70%|██████████████████████████████▏            | 117/167 [00:05<00:02, 23.21it/s]Encode all items:  72%|██████████████████████████████▉            | 120/167 [00:05<00:01, 23.90it/s]Encode all items:  74%|███████████████████████████████▋           | 123/167 [00:05<00:01, 23.98it/s]Encode all items:  75%|████████████████████████████████▍          | 126/167 [00:05<00:01, 24.00it/s]Encode all items:  77%|█████████████████████████████████▏         | 129/167 [00:05<00:01, 23.62it/s]Encode all items:  79%|█████████████████████████████████▉         | 132/167 [00:05<00:01, 23.39it/s]Encode all items:  81%|██████████████████████████████████▊        | 135/167 [00:05<00:01, 24.04it/s]Encode all items:  83%|███████████████████████████████████▌       | 138/167 [00:05<00:01, 24.06it/s]Encode all items:  84%|████████████████████████████████████▎      | 141/167 [00:06<00:01, 23.23it/s]Encode all items:  86%|█████████████████████████████████████      | 144/167 [00:06<00:00, 23.11it/s]Encode all items:  88%|█████████████████████████████████████▊     | 147/167 [00:06<00:00, 23.03it/s]Encode all items:  90%|██████████████████████████████████████▌    | 150/167 [00:06<00:00, 22.98it/s]Encode all items:  92%|███████████████████████████████████████▍   | 153/167 [00:06<00:00, 22.96it/s]Encode all items:  93%|████████████████████████████████████████▏  | 156/167 [00:06<00:00, 22.94it/s]Encode all items:  95%|████████████████████████████████████████▉  | 159/167 [00:06<00:00, 23.69it/s]Encode all items:  97%|█████████████████████████████████████████▋ | 162/167 [00:06<00:00, 23.84it/s]Encode all items:  99%|██████████████████████████████████████████▍| 165/167 [00:07<00:00, 23.94it/s]Encode all items: 100%|███████████████████████████████████████████| 167/167 [00:07<00:00, 23.43it/s]
Initalize item embeddings from vectors.
Training:   0%|                                                              | 0/25 [00:00<?, ?it/s]Training:   4%|██▏                                                   | 1/25 [00:00<00:21,  1.10it/s]Training:   8%|████▎                                                 | 2/25 [00:01<00:12,  1.79it/s]Training:  12%|██████▍                                               | 3/25 [00:01<00:09,  2.28it/s]Training:  16%|████████▋                                             | 4/25 [00:01<00:08,  2.59it/s]Training:  20%|██████████▊                                           | 5/25 [00:02<00:07,  2.82it/s]Training:  24%|████████████▉                                         | 6/25 [00:02<00:06,  2.99it/s]Training:  28%|███████████████                                       | 7/25 [00:02<00:05,  3.11it/s]Training:  32%|█████████████████▎                                    | 8/25 [00:03<00:05,  3.16it/s]Training:  36%|███████████████████▍                                  | 9/25 [00:03<00:05,  3.17it/s]Training:  40%|█████████████████████▏                               | 10/25 [00:03<00:04,  3.19it/s]Training:  44%|███████████████████████▎                             | 11/25 [00:03<00:04,  3.24it/s]Training:  48%|█████████████████████████▍                           | 12/25 [00:04<00:04,  3.20it/s]Training:  52%|███████████████████████████▌                         | 13/25 [00:04<00:03,  3.26it/s]Training:  56%|█████████████████████████████▋                       | 14/25 [00:04<00:03,  3.26it/s]Training:  60%|███████████████████████████████▊                     | 15/25 [00:05<00:03,  3.28it/s]Training:  64%|█████████████████████████████████▉                   | 16/25 [00:05<00:03,  2.80it/s]Training:  68%|████████████████████████████████████                 | 17/25 [00:05<00:02,  2.96it/s]Training:  72%|██████████████████████████████████████▏              | 18/25 [00:06<00:02,  3.05it/s]Training:  76%|████████████████████████████████████████▎            | 19/25 [00:06<00:01,  3.15it/s]Training:  80%|██████████████████████████████████████████▍          | 20/25 [00:06<00:01,  3.18it/s]Training:  84%|████████████████████████████████████████████▌        | 21/25 [00:07<00:01,  3.25it/s]Training:  88%|██████████████████████████████████████████████▋      | 22/25 [00:07<00:00,  3.25it/s]Training:  92%|████████████████████████████████████████████████▊    | 23/25 [00:07<00:00,  3.36it/s]Training:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:08<00:00,  3.34it/s]Training: 100%|█████████████████████████████████████████████████████| 25/25 [00:08<00:00,  3.37it/s]Training: 100%|█████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.97it/s]
Evaluate:   0%|                                                              | 0/25 [00:00<?, ?it/s]Evaluate:   4%|██▏                                                   | 1/25 [00:00<00:21,  1.13it/s]Evaluate:   8%|████▎                                                 | 2/25 [00:01<00:11,  2.01it/s]Evaluate:  12%|██████▍                                               | 3/25 [00:01<00:08,  2.58it/s]Evaluate:  16%|████████▋                                             | 4/25 [00:01<00:07,  3.00it/s]Evaluate:  20%|██████████▊                                           | 5/25 [00:01<00:06,  3.31it/s]Evaluate:  24%|████████████▉                                         | 6/25 [00:02<00:05,  3.60it/s]Evaluate:  28%|███████████████                                       | 7/25 [00:02<00:04,  3.83it/s]Evaluate:  32%|█████████████████▎                                    | 8/25 [00:02<00:04,  3.89it/s]Evaluate:  36%|███████████████████▍                                  | 9/25 [00:02<00:04,  3.89it/s]Evaluate:  40%|█████████████████████▏                               | 10/25 [00:03<00:03,  3.90it/s]Evaluate:  44%|███████████████████████▎                             | 11/25 [00:03<00:03,  3.92it/s]Evaluate:  48%|█████████████████████████▍                           | 12/25 [00:03<00:03,  3.92it/s]Evaluate:  52%|███████████████████████████▌                         | 13/25 [00:03<00:03,  3.99it/s]Evaluate:  56%|█████████████████████████████▋                       | 14/25 [00:04<00:02,  3.94it/s]Evaluate:  60%|███████████████████████████████▊                     | 15/25 [00:04<00:02,  3.93it/s]Evaluate:  64%|█████████████████████████████████▉                   | 16/25 [00:04<00:02,  4.00it/s]Evaluate:  68%|████████████████████████████████████                 | 17/25 [00:04<00:01,  4.08it/s]Evaluate:  72%|██████████████████████████████████████▏              | 18/25 [00:05<00:01,  4.01it/s]Evaluate:  76%|████████████████████████████████████████▎            | 19/25 [00:05<00:01,  3.96it/s]Evaluate:  80%|██████████████████████████████████████████▍          | 20/25 [00:05<00:01,  3.94it/s]Evaluate:  84%|████████████████████████████████████████████▌        | 21/25 [00:05<00:00,  4.05it/s]Evaluate:  88%|██████████████████████████████████████████████▋      | 22/25 [00:06<00:00,  4.05it/s]Evaluate:  92%|████████████████████████████████████████████████▊    | 23/25 [00:06<00:00,  4.04it/s]Evaluate:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:06<00:00,  3.99it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:06<00:00,  3.94it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:06<00:00,  3.59it/s]
Epoch: 6. Dev set: {'NDCG@10': 0.04305503606796265, 'Recall@10': 0.07641666680574417, 'NDCG@50': 0.06475552156567574, 'Recall@50': 0.17366666793823243, 'MRR': 0.03957977676764131, 'AUC': 0.7585753989219666}
No improvement. Patience: 1/5

Epoch 7/50
Training:   0%|                                                              | 0/25 [00:00<?, ?it/s]Training:   4%|██▏                                                   | 1/25 [00:00<00:22,  1.09it/s]Training:   8%|████▎                                                 | 2/25 [00:01<00:14,  1.53it/s]Training:  12%|██████▍                                               | 3/25 [00:01<00:10,  2.05it/s]Training:  16%|████████▋                                             | 4/25 [00:01<00:08,  2.45it/s]Training:  20%|██████████▊                                           | 5/25 [00:02<00:07,  2.73it/s]Training:  24%|████████████▉                                         | 6/25 [00:02<00:06,  2.91it/s]Training:  28%|███████████████                                       | 7/25 [00:02<00:05,  3.05it/s]Training:  32%|█████████████████▎                                    | 8/25 [00:03<00:05,  3.12it/s]Training:  36%|███████████████████▍                                  | 9/25 [00:03<00:04,  3.20it/s]Training:  40%|█████████████████████▏                               | 10/25 [00:03<00:04,  3.22it/s]Training:  44%|███████████████████████▎                             | 11/25 [00:04<00:04,  3.27it/s]Training:  48%|█████████████████████████▍                           | 12/25 [00:04<00:03,  3.27it/s]Training:  52%|███████████████████████████▌                         | 13/25 [00:04<00:03,  3.30it/s]Training:  56%|█████████████████████████████▋                       | 14/25 [00:04<00:03,  3.29it/s]Training:  60%|███████████████████████████████▊                     | 15/25 [00:05<00:02,  3.36it/s]Training:  64%|█████████████████████████████████▉                   | 16/25 [00:05<00:02,  3.32it/s]Training:  68%|████████████████████████████████████                 | 17/25 [00:05<00:02,  3.35it/s]Training:  72%|██████████████████████████████████████▏              | 18/25 [00:06<00:02,  3.32it/s]Training:  76%|████████████████████████████████████████▎            | 19/25 [00:06<00:01,  3.36it/s]Training:  80%|██████████████████████████████████████████▍          | 20/25 [00:06<00:01,  3.32it/s]Training:  84%|████████████████████████████████████████████▌        | 21/25 [00:07<00:01,  3.37it/s]Training:  88%|██████████████████████████████████████████████▋      | 22/25 [00:07<00:00,  3.33it/s]Training:  92%|████████████████████████████████████████████████▊    | 23/25 [00:07<00:00,  3.37it/s]Training:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:07<00:00,  3.49it/s]Training: 100%|█████████████████████████████████████████████████████| 25/25 [00:08<00:00,  3.50it/s]Training: 100%|█████████████████████████████████████████████████████| 25/25 [00:08<00:00,  3.01it/s]
Evaluate:   0%|                                                              | 0/25 [00:00<?, ?it/s]Evaluate:   4%|██▏                                                   | 1/25 [00:01<00:24,  1.01s/it]Evaluate:   8%|████▎                                                 | 2/25 [00:01<00:13,  1.75it/s]Evaluate:  12%|██████▍                                               | 3/25 [00:01<00:09,  2.34it/s]Evaluate:  16%|████████▋                                             | 4/25 [00:01<00:07,  2.78it/s]Evaluate:  20%|██████████▊                                           | 5/25 [00:02<00:06,  3.12it/s]Evaluate:  24%|████████████▉                                         | 6/25 [00:02<00:05,  3.35it/s]Evaluate:  28%|███████████████                                       | 7/25 [00:02<00:05,  3.49it/s]Evaluate:  32%|█████████████████▎                                    | 8/25 [00:02<00:04,  3.59it/s]Evaluate:  36%|███████████████████▍                                  | 9/25 [00:03<00:04,  3.69it/s]Evaluate:  40%|█████████████████████▏                               | 10/25 [00:03<00:03,  3.79it/s]Evaluate:  44%|███████████████████████▎                             | 11/25 [00:03<00:03,  3.83it/s]Evaluate:  48%|█████████████████████████▍                           | 12/25 [00:03<00:03,  3.87it/s]Evaluate:  52%|███████████████████████████▌                         | 13/25 [00:04<00:04,  2.88it/s]Evaluate:  56%|█████████████████████████████▋                       | 14/25 [00:04<00:03,  3.15it/s]Evaluate:  60%|███████████████████████████████▊                     | 15/25 [00:04<00:02,  3.35it/s]Evaluate:  64%|█████████████████████████████████▉                   | 16/25 [00:05<00:02,  3.51it/s]Evaluate:  68%|████████████████████████████████████                 | 17/25 [00:05<00:02,  3.57it/s]Evaluate:  72%|██████████████████████████████████████▏              | 18/25 [00:05<00:01,  3.64it/s]Evaluate:  76%|████████████████████████████████████████▎            | 19/25 [00:05<00:01,  3.68it/s]Evaluate:  80%|██████████████████████████████████████████▍          | 20/25 [00:06<00:01,  3.70it/s]Evaluate:  84%|████████████████████████████████████████████▌        | 21/25 [00:06<00:01,  3.72it/s]Evaluate:  88%|██████████████████████████████████████████████▋      | 22/25 [00:06<00:00,  3.74it/s]Evaluate:  92%|████████████████████████████████████████████████▊    | 23/25 [00:06<00:00,  3.72it/s]Evaluate:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:07<00:00,  3.74it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:07<00:00,  3.69it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:07<00:00,  3.26it/s]
Epoch: 7. Dev set: {'NDCG@10': 0.06260664120316506, 'Recall@10': 0.10175000071525574, 'NDCG@50': 0.07848624248057604, 'Recall@50': 0.17475000143051148, 'MRR': 0.05577640263363719, 'AUC': 0.7560459399223327}
No improvement. Patience: 0/5
Early stopping triggered in Stage 1

=== Stage 2: Fine-tuning with Best Model (patience=3) ===
Load best model from stage 1.

Stage 2 - Epoch 1/50
Training:   0%|                                                              | 0/25 [00:00<?, ?it/s]Training:   4%|██▏                                                   | 1/25 [00:00<00:22,  1.08it/s]Training:   8%|████▎                                                 | 2/25 [00:01<00:12,  1.77it/s]Training:  12%|██████▍                                               | 3/25 [00:01<00:09,  2.27it/s]Training:  16%|████████▋                                             | 4/25 [00:01<00:08,  2.58it/s]Training:  20%|██████████▊                                           | 5/25 [00:02<00:07,  2.83it/s]Training:  24%|████████████▉                                         | 6/25 [00:02<00:06,  2.94it/s]Training:  28%|███████████████                                       | 7/25 [00:02<00:05,  3.05it/s]Training:  32%|█████████████████▎                                    | 8/25 [00:03<00:05,  3.11it/s]Training:  36%|███████████████████▍                                  | 9/25 [00:03<00:05,  3.18it/s]Training:  40%|█████████████████████▏                               | 10/25 [00:03<00:04,  3.21it/s]Training:  44%|███████████████████████▎                             | 11/25 [00:03<00:04,  3.26it/s]Training:  48%|█████████████████████████▍                           | 12/25 [00:04<00:03,  3.27it/s]Training:  52%|███████████████████████████▌                         | 13/25 [00:04<00:03,  3.30it/s]Training:  56%|█████████████████████████████▋                       | 14/25 [00:04<00:03,  3.28it/s]Training:  60%|███████████████████████████████▊                     | 15/25 [00:05<00:02,  3.35it/s]Training:  64%|█████████████████████████████████▉                   | 16/25 [00:05<00:02,  3.32it/s]Training:  68%|████████████████████████████████████                 | 17/25 [00:05<00:02,  3.34it/s]Training:  72%|██████████████████████████████████████▏              | 18/25 [00:06<00:02,  3.32it/s]Training:  76%|████████████████████████████████████████▎            | 19/25 [00:06<00:01,  3.34it/s]Training:  80%|██████████████████████████████████████████▍          | 20/25 [00:06<00:01,  2.86it/s]Training:  84%|████████████████████████████████████████████▌        | 21/25 [00:07<00:01,  3.00it/s]Training:  88%|██████████████████████████████████████████████▋      | 22/25 [00:07<00:00,  3.07it/s]Training:  92%|████████████████████████████████████████████████▊    | 23/25 [00:07<00:00,  3.16it/s]Training:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:08<00:00,  3.20it/s]Training: 100%|█████████████████████████████████████████████████████| 25/25 [00:08<00:00,  3.26it/s]Training: 100%|█████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.96it/s]
Evaluate:   0%|                                                              | 0/25 [00:00<?, ?it/s]Evaluate:   4%|██▏                                                   | 1/25 [00:00<00:20,  1.15it/s]Evaluate:   8%|████▎                                                 | 2/25 [00:01<00:11,  2.03it/s]Evaluate:  12%|██████▍                                               | 3/25 [00:01<00:08,  2.61it/s]Evaluate:  16%|████████▋                                             | 4/25 [00:01<00:06,  3.01it/s]Evaluate:  20%|██████████▊                                           | 5/25 [00:01<00:06,  3.30it/s]Evaluate:  24%|████████████▉                                         | 6/25 [00:02<00:05,  3.57it/s]Evaluate:  28%|███████████████                                       | 7/25 [00:02<00:04,  3.69it/s]Evaluate:  32%|█████████████████▎                                    | 8/25 [00:02<00:04,  3.75it/s]Evaluate:  36%|███████████████████▍                                  | 9/25 [00:02<00:04,  3.81it/s]Evaluate:  40%|█████████████████████▏                               | 10/25 [00:03<00:03,  3.86it/s]Evaluate:  44%|███████████████████████▎                             | 11/25 [00:03<00:03,  3.90it/s]Evaluate:  48%|█████████████████████████▍                           | 12/25 [00:03<00:03,  3.92it/s]Evaluate:  52%|███████████████████████████▌                         | 13/25 [00:03<00:03,  3.94it/s]Evaluate:  56%|█████████████████████████████▋                       | 14/25 [00:04<00:02,  3.97it/s]Evaluate:  60%|███████████████████████████████▊                     | 15/25 [00:04<00:02,  3.97it/s]Evaluate:  64%|█████████████████████████████████▉                   | 16/25 [00:04<00:02,  3.97it/s]Evaluate:  68%|████████████████████████████████████                 | 17/25 [00:04<00:02,  3.99it/s]Evaluate:  72%|██████████████████████████████████████▏              | 18/25 [00:05<00:01,  3.99it/s]Evaluate:  76%|████████████████████████████████████████▎            | 19/25 [00:05<00:01,  3.99it/s]Evaluate:  80%|██████████████████████████████████████████▍          | 20/25 [00:05<00:01,  3.94it/s]Evaluate:  84%|████████████████████████████████████████████▌        | 21/25 [00:05<00:01,  3.93it/s]Evaluate:  88%|██████████████████████████████████████████████▋      | 22/25 [00:06<00:00,  3.98it/s]Evaluate:  92%|████████████████████████████████████████████████▊    | 23/25 [00:06<00:00,  3.96it/s]Evaluate:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:06<00:00,  3.96it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:06<00:00,  3.93it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:07<00:00,  3.57it/s]
Epoch: 1. Dev set: {'NDCG@10': 0.05401620917022228, 'Recall@10': 0.09125, 'NDCG@50': 0.0731662729382515, 'Recall@50': 0.17633333444595337, 'MRR': 0.048805315606296064, 'AUC': 0.7476155090332032}
No improvement. Patience: 2/3

Stage 2 - Epoch 2/50
Training:   0%|                                                              | 0/25 [00:00<?, ?it/s]Training:   4%|██▏                                                   | 1/25 [00:00<00:22,  1.06it/s]Training:   8%|████▎                                                 | 2/25 [00:01<00:13,  1.75it/s]Training:  12%|██████▍                                               | 3/25 [00:01<00:09,  2.27it/s]Training:  16%|████████▋                                             | 4/25 [00:01<00:08,  2.58it/s]Training:  20%|██████████▊                                           | 5/25 [00:02<00:07,  2.86it/s]Training:  24%|████████████▉                                         | 6/25 [00:02<00:06,  2.96it/s]Training:  28%|███████████████                                       | 7/25 [00:02<00:06,  2.64it/s]Training:  32%|█████████████████▎                                    | 8/25 [00:03<00:06,  2.83it/s]Training:  36%|███████████████████▍                                  | 9/25 [00:03<00:05,  2.95it/s]Training:  40%|█████████████████████▏                               | 10/25 [00:03<00:04,  3.01it/s]Training:  44%|███████████████████████▎                             | 11/25 [00:04<00:04,  3.10it/s]Training:  48%|█████████████████████████▍                           | 12/25 [00:04<00:04,  3.11it/s]Training:  52%|███████████████████████████▌                         | 13/25 [00:04<00:03,  3.16it/s]Training:  56%|█████████████████████████████▋                       | 14/25 [00:05<00:03,  3.10it/s]Training:  60%|███████████████████████████████▊                     | 15/25 [00:05<00:03,  3.19it/s]Training:  64%|█████████████████████████████████▉                   | 16/25 [00:05<00:02,  3.16it/s]Training:  68%|████████████████████████████████████                 | 17/25 [00:06<00:02,  3.19it/s]Training:  72%|██████████████████████████████████████▏              | 18/25 [00:06<00:02,  3.15it/s]Training:  76%|████████████████████████████████████████▎            | 19/25 [00:06<00:01,  3.17it/s]Training:  80%|██████████████████████████████████████████▍          | 20/25 [00:06<00:01,  3.13it/s]Training:  84%|████████████████████████████████████████████▌        | 21/25 [00:07<00:01,  3.15it/s]Training:  88%|██████████████████████████████████████████████▋      | 22/25 [00:07<00:00,  3.13it/s]Training:  92%|████████████████████████████████████████████████▊    | 23/25 [00:07<00:00,  3.17it/s]Training:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:08<00:00,  3.20it/s]Training: 100%|█████████████████████████████████████████████████████| 25/25 [00:08<00:00,  3.15it/s]Training: 100%|█████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.88it/s]
Evaluate:   0%|                                                              | 0/25 [00:00<?, ?it/s]Evaluate:   4%|██▏                                                   | 1/25 [00:00<00:20,  1.14it/s]Evaluate:   8%|████▎                                                 | 2/25 [00:01<00:11,  1.98it/s]Evaluate:  12%|██████▍                                               | 3/25 [00:01<00:08,  2.59it/s]Evaluate:  16%|████████▋                                             | 4/25 [00:01<00:06,  3.01it/s]Evaluate:  20%|██████████▊                                           | 5/25 [00:01<00:06,  3.29it/s]Evaluate:  24%|████████████▉                                         | 6/25 [00:02<00:05,  3.53it/s]Evaluate:  28%|███████████████                                       | 7/25 [00:02<00:04,  3.67it/s]Evaluate:  32%|█████████████████▎                                    | 8/25 [00:02<00:04,  3.84it/s]Evaluate:  36%|███████████████████▍                                  | 9/25 [00:02<00:04,  3.95it/s]Evaluate:  40%|█████████████████████▏                               | 10/25 [00:03<00:03,  4.05it/s]Evaluate:  44%|███████████████████████▎                             | 11/25 [00:03<00:03,  4.03it/s]Evaluate:  48%|█████████████████████████▍                           | 12/25 [00:03<00:03,  4.06it/s]Evaluate:  52%|███████████████████████████▌                         | 13/25 [00:03<00:02,  4.04it/s]Evaluate:  56%|█████████████████████████████▋                       | 14/25 [00:04<00:02,  4.00it/s]Evaluate:  60%|███████████████████████████████▊                     | 15/25 [00:04<00:03,  3.33it/s]Evaluate:  64%|█████████████████████████████████▉                   | 16/25 [00:04<00:02,  3.52it/s]Evaluate:  68%|████████████████████████████████████                 | 17/25 [00:04<00:02,  3.64it/s]Evaluate:  72%|██████████████████████████████████████▏              | 18/25 [00:05<00:01,  3.75it/s]Evaluate:  76%|████████████████████████████████████████▎            | 19/25 [00:05<00:01,  3.83it/s]Evaluate:  80%|██████████████████████████████████████████▍          | 20/25 [00:05<00:01,  3.86it/s]Evaluate:  84%|████████████████████████████████████████████▌        | 21/25 [00:05<00:01,  3.91it/s]Evaluate:  88%|██████████████████████████████████████████████▋      | 22/25 [00:06<00:00,  3.92it/s]Evaluate:  92%|████████████████████████████████████████████████▊    | 23/25 [00:06<00:00,  3.92it/s]Evaluate:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:06<00:00,  3.89it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:07<00:00,  3.86it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:07<00:00,  3.51it/s]
Epoch: 2. Dev set: {'NDCG@10': 0.06480774581432343, 'Recall@10': 0.10833333373069763, 'NDCG@50': 0.0798511752486229, 'Recall@50': 0.1786666679382324, 'MRR': 0.056233025523833934, 'AUC': 0.7466685056686402}
No improvement. Patience: 1/3

Stage 2 - Epoch 3/50
Training:   0%|                                                              | 0/25 [00:00<?, ?it/s]Training:   4%|██▏                                                   | 1/25 [00:00<00:22,  1.08it/s]Training:   8%|████▎                                                 | 2/25 [00:01<00:13,  1.76it/s]Training:  12%|██████▍                                               | 3/25 [00:01<00:09,  2.27it/s]Training:  16%|████████▋                                             | 4/25 [00:01<00:08,  2.57it/s]Training:  20%|██████████▊                                           | 5/25 [00:02<00:07,  2.84it/s]Training:  24%|████████████▉                                         | 6/25 [00:02<00:06,  3.02it/s]Training:  28%|███████████████                                       | 7/25 [00:02<00:05,  3.16it/s]Training:  32%|█████████████████▎                                    | 8/25 [00:03<00:05,  3.21it/s]Training:  36%|███████████████████▍                                  | 9/25 [00:03<00:04,  3.27it/s]Training:  40%|█████████████████████▏                               | 10/25 [00:03<00:04,  3.28it/s]Training:  44%|███████████████████████▎                             | 11/25 [00:03<00:04,  3.32it/s]Training:  48%|█████████████████████████▍                           | 12/25 [00:04<00:03,  3.32it/s]Training:  52%|███████████████████████████▌                         | 13/25 [00:04<00:03,  3.41it/s]Training:  56%|█████████████████████████████▋                       | 14/25 [00:04<00:03,  3.38it/s]Training:  60%|███████████████████████████████▊                     | 15/25 [00:05<00:02,  3.39it/s]Training:  64%|█████████████████████████████████▉                   | 16/25 [00:05<00:02,  3.40it/s]Training:  68%|████████████████████████████████████                 | 17/25 [00:05<00:02,  3.41it/s]Training:  72%|██████████████████████████████████████▏              | 18/25 [00:05<00:02,  3.42it/s]Training:  76%|████████████████████████████████████████▎            | 19/25 [00:06<00:01,  3.44it/s]Training:  80%|██████████████████████████████████████████▍          | 20/25 [00:06<00:01,  3.44it/s]Training:  84%|████████████████████████████████████████████▌        | 21/25 [00:06<00:01,  3.49it/s]Training:  88%|██████████████████████████████████████████████▋      | 22/25 [00:07<00:01,  3.00it/s]Training:  92%|████████████████████████████████████████████████▊    | 23/25 [00:07<00:00,  3.14it/s]Training:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:07<00:00,  3.21it/s]Training: 100%|█████████████████████████████████████████████████████| 25/25 [00:08<00:00,  3.26it/s]Training: 100%|█████████████████████████████████████████████████████| 25/25 [00:08<00:00,  3.04it/s]
Evaluate:   0%|                                                              | 0/25 [00:00<?, ?it/s]Evaluate:   4%|██▏                                                   | 1/25 [00:00<00:20,  1.19it/s]Evaluate:   8%|████▎                                                 | 2/25 [00:01<00:10,  2.09it/s]Evaluate:  12%|██████▍                                               | 3/25 [00:01<00:08,  2.69it/s]Evaluate:  16%|████████▋                                             | 4/25 [00:01<00:06,  3.13it/s]Evaluate:  20%|██████████▊                                           | 5/25 [00:01<00:05,  3.42it/s]Evaluate:  24%|████████████▉                                         | 6/25 [00:02<00:05,  3.59it/s]Evaluate:  28%|███████████████                                       | 7/25 [00:02<00:04,  3.74it/s]Evaluate:  32%|█████████████████▎                                    | 8/25 [00:02<00:04,  3.83it/s]Evaluate:  36%|███████████████████▍                                  | 9/25 [00:02<00:04,  3.87it/s]Evaluate:  40%|█████████████████████▏                               | 10/25 [00:03<00:03,  3.93it/s]Evaluate:  44%|███████████████████████▎                             | 11/25 [00:03<00:03,  4.01it/s]Evaluate:  48%|█████████████████████████▍                           | 12/25 [00:03<00:03,  4.07it/s]Evaluate:  52%|███████████████████████████▌                         | 13/25 [00:03<00:02,  4.02it/s]Evaluate:  56%|█████████████████████████████▋                       | 14/25 [00:04<00:02,  4.03it/s]Evaluate:  60%|███████████████████████████████▊                     | 15/25 [00:04<00:02,  4.00it/s]Evaluate:  64%|█████████████████████████████████▉                   | 16/25 [00:04<00:02,  4.00it/s]Evaluate:  68%|████████████████████████████████████                 | 17/25 [00:04<00:02,  3.96it/s]Evaluate:  72%|██████████████████████████████████████▏              | 18/25 [00:05<00:01,  3.97it/s]Evaluate:  76%|████████████████████████████████████████▎            | 19/25 [00:05<00:01,  4.00it/s]Evaluate:  80%|██████████████████████████████████████████▍          | 20/25 [00:05<00:01,  4.00it/s]Evaluate:  84%|████████████████████████████████████████████▌        | 21/25 [00:05<00:01,  3.95it/s]Evaluate:  88%|██████████████████████████████████████████████▋      | 22/25 [00:06<00:00,  3.94it/s]Evaluate:  92%|████████████████████████████████████████████████▊    | 23/25 [00:06<00:00,  3.97it/s]Evaluate:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:06<00:00,  4.00it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:06<00:00,  3.91it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:06<00:00,  3.62it/s]
Epoch: 3. Dev set: {'NDCG@10': 0.061225411966443065, 'Recall@10': 0.10441666722297668, 'NDCG@50': 0.07719409354031086, 'Recall@50': 0.1786666679382324, 'MRR': 0.05312777554150671, 'AUC': 0.7475547194480896}
No improvement. Patience: 0/3
Early stopping triggered in Stage 2

=== Final Evaluation ===
Test with the best checkpoint.
Evaluate:   0%|                                                              | 0/25 [00:00<?, ?it/s]Evaluate:   4%|██▏                                                   | 1/25 [00:00<00:20,  1.16it/s]Evaluate:   8%|████▎                                                 | 2/25 [00:01<00:11,  1.95it/s]Evaluate:  12%|██████▍                                               | 3/25 [00:01<00:08,  2.54it/s]Evaluate:  16%|████████▋                                             | 4/25 [00:01<00:07,  2.99it/s]Evaluate:  20%|██████████▊                                           | 5/25 [00:01<00:06,  3.33it/s]Evaluate:  24%|████████████▉                                         | 6/25 [00:02<00:05,  3.53it/s]Evaluate:  28%|███████████████                                       | 7/25 [00:02<00:04,  3.69it/s]Evaluate:  32%|█████████████████▎                                    | 8/25 [00:02<00:04,  3.74it/s]Evaluate:  36%|███████████████████▍                                  | 9/25 [00:02<00:04,  3.80it/s]Evaluate:  40%|█████████████████████▏                               | 10/25 [00:03<00:03,  3.87it/s]Evaluate:  44%|███████████████████████▎                             | 11/25 [00:03<00:03,  3.90it/s]Evaluate:  48%|█████████████████████████▍                           | 12/25 [00:03<00:03,  3.94it/s]Evaluate:  52%|███████████████████████████▌                         | 13/25 [00:03<00:03,  3.99it/s]Evaluate:  56%|█████████████████████████████▋                       | 14/25 [00:04<00:02,  3.97it/s]Evaluate:  60%|███████████████████████████████▊                     | 15/25 [00:04<00:02,  3.97it/s]Evaluate:  64%|█████████████████████████████████▉                   | 16/25 [00:04<00:02,  3.30it/s]Evaluate:  68%|████████████████████████████████████                 | 17/25 [00:05<00:02,  3.49it/s]Evaluate:  72%|██████████████████████████████████████▏              | 18/25 [00:05<00:01,  3.62it/s]Evaluate:  76%|████████████████████████████████████████▎            | 19/25 [00:05<00:01,  3.72it/s]Evaluate:  80%|██████████████████████████████████████████▍          | 20/25 [00:05<00:01,  3.79it/s]Evaluate:  84%|████████████████████████████████████████████▌        | 21/25 [00:06<00:01,  3.90it/s]Evaluate:  88%|██████████████████████████████████████████████▋      | 22/25 [00:06<00:00,  3.92it/s]Evaluate:  92%|████████████████████████████████████████████████▊    | 23/25 [00:06<00:00,  3.93it/s]Evaluate:  96%|██████████████████████████████████████████████████▉  | 24/25 [00:06<00:00,  3.94it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:07<00:00,  3.89it/s]Evaluate: 100%|█████████████████████████████████████████████████████| 25/25 [00:07<00:00,  3.48it/s]
Final Test set: {'NDCG@10': 0.05161935266107321, 'Recall@10': 0.08033333361148834, 'NDCG@50': 0.06383467016741634, 'Recall@50': 0.13566666722297668, 'MRR': 0.047416461575776336, 'AUC': 0.7254984092712402}

=== Training Completed ===
Best NDCG@10: 0.069400
Total patience triggers: 5
=== Job Completion ===
End time: Mon Jun 23 10:44:11 CEST 2025
Job finished with exit code: 0

JOB STATISTICS
==============
Job ID: 12566042
Cluster: snellius
User/Group: scur2746/scur2746
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 64
CPU Utilized: 00:06:39
CPU Efficiency: 2.83% of 03:54:40 core-walltime
Job Wall-clock time: 00:03:40
Memory Utilized: 3.18 GB
Memory Efficiency: 1.32% of 240.00 GB (240.00 GB/node)
