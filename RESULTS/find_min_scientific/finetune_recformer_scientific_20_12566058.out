=== Job Information ===
Job ID: 12566058
Node: gcn114
Start time: Mon Jun 23 10:41:12 CEST 2025
Available GPUs: 0,1,2,3
Available CPUs: 32
Available Memory: 245760
============================================================================================== 
Warning! Mixing Conda and module environments may lead to corruption of the
user environment. 
We do not recommend users mixing those two environments unless absolutely
necessary. Note that 
SURF does not provide any support for Conda environment.
For more information, please refer to our software policy page:
https://servicedesk.surf.nl/wiki/display/WIKI/Software+policy+Snellius#SoftwarepolicySnellius-UseofAnacondaandMinicondaenvironmentsonSnellius 

Remember that many packages have already been installed on the system and can
be loaded using 
the 'module load <package__name>' command. If you are uncertain if a package is
already available 
on the system, please use 'module avail' or 'module spider' to search for it.
============================================================================================== 
=== Environment Check ===
PyTorch version: 2.7.1+cu126
CUDA available: True
CUDA devices: 4
Starting Optimized RecFormer fine-tuning using the MIND dataset...
=== Training Configuration ===
Multi-GPU: 4 H100 GPUs
Batch size per GPU: 32 (Total effective: ~128 with gradient accumulation)
Max epochs: 50 (with early stopping)
Data workers: 16 per DataLoader
Preprocessing workers: 32
[rank: 0] Global seed set to 42
/gpfs/home2/scur2746/recformer_env/lib/python3.10/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LongformerTokenizer'. 
The class this function is called from is 'RecformerTokenizer'.
Namespace(pretrain_ckpt='pretrained_models/recformer_seqrec_ckpt.bin', data_path='finetune_data/Scientific', output_dir='checkpoints', ckpt='best_model.bin', model_name_or_path='allenai/longformer-base-4096', train_file='train.json', dev_file='val.json', test_file='test.json', item2id_file='smap.json', meta_file='meta_data.json', preprocessing_num_workers=32, dataloader_num_workers=16, temp=0.05, num_train_epochs=50, gradient_accumulation_steps=2, finetune_negative_sample_size=-1, metric_ks=[10, 50], batch_size=32, learning_rate=5e-05, weight_decay=0, warmup_steps=100, device=0, fp16=True, fix_word_embedding=False, verbose=1, min_inter=20, multi_gpu=True, gpu_ids='0,1,2,3', pin_memory=True, cache_item_embeddings=True)
Using multi-GPU training on GPUs: [0, 1, 2, 3]
Before min_inter=20, users count: train=11041, val=11039, test=11039
After min_inter=20, users count: train=96, val=96, test=96
Tokenize all items...
/gpfs/home2/scur2746/recformer_toy/RecFormer/python_scripts/finetune_optimized.py:335: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Using 32 workers with chunksize 20 for tokenization.
Amazon dataset detected, using RecformerTrainDataset and RecformerEvalDataset.
Model wrapped with DataParallel using GPUs: [0, 1, 2, 3]
[Item Embeddings] Use cache: finetune_data/Scientific/preprocess/item_embeddings_Scientific
Initalize item embeddings from vectors.
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]/gpfs/home2/scur2746/recformer_env/lib/python3.10/site-packages/transformers/modeling_utils.py:862: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
Evaluate:  33%|██████████████████▎                                    | 1/3 [00:03<00:06,  3.29s/it]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:03<00:01,  1.59s/it]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:03<00:00,  1.02it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:03<00:00,  1.33s/it]
Initial Test set: {'NDCG@10': 0.016988851750890415, 'Recall@10': 0.020833333333333332, 'NDCG@50': 0.027740628148118656, 'Recall@50': 0.07291666666666667, 'MRR': 0.0194980523083359, 'AUC': 0.6867549618085226}

=== Starting Training ===
Total epochs: 50
Batch size: 32
Gradient accumulation steps: 2
Effective batch size: 64

=== Stage 1: Initial Training (patience=5) ===

Epoch 1/50
Re-encoding items...
Encode all items:   0%|                                                     | 0/167 [00:00<?, ?it/s]Encode all items:   1%|▌                                            | 2/167 [00:00<00:08, 19.43it/s]Encode all items:   3%|█▎                                           | 5/167 [00:00<00:07, 21.62it/s]Encode all items:   5%|██▏                                          | 8/167 [00:00<00:07, 22.20it/s]Encode all items:   7%|██▉                                         | 11/167 [00:00<00:07, 21.96it/s]Encode all items:   8%|███▋                                        | 14/167 [00:00<00:06, 22.24it/s]Encode all items:  10%|████▍                                       | 17/167 [00:00<00:06, 22.69it/s]Encode all items:  12%|█████▎                                      | 20/167 [00:00<00:06, 22.74it/s]Encode all items:  14%|██████                                      | 23/167 [00:01<00:06, 23.17it/s]Encode all items:  16%|██████▊                                     | 26/167 [00:01<00:06, 23.07it/s]Encode all items:  17%|███████▋                                    | 29/167 [00:01<00:05, 23.80it/s]Encode all items:  19%|████████▍                                   | 32/167 [00:01<00:05, 23.75it/s]Encode all items:  21%|█████████▏                                  | 35/167 [00:01<00:05, 23.86it/s]Encode all items:  23%|██████████                                  | 38/167 [00:01<00:05, 23.53it/s]Encode all items:  25%|██████████▊                                 | 41/167 [00:01<00:05, 23.72it/s]Encode all items:  26%|███████████▌                                | 44/167 [00:01<00:05, 23.84it/s]Encode all items:  28%|████████████▍                               | 47/167 [00:02<00:05, 23.94it/s]Encode all items:  30%|█████████████▏                              | 50/167 [00:02<00:04, 24.43it/s]Encode all items:  32%|█████████████▉                              | 53/167 [00:02<00:04, 23.52it/s]Encode all items:  34%|██████████████▊                             | 56/167 [00:02<00:04, 23.69it/s]Encode all items:  35%|███████████████▌                            | 59/167 [00:02<00:04, 23.04it/s]Encode all items:  37%|████████████████▎                           | 62/167 [00:02<00:04, 23.36it/s]Encode all items:  39%|█████████████████▏                          | 65/167 [00:02<00:04, 24.01it/s]Encode all items:  41%|█████████████████▉                          | 68/167 [00:02<00:04, 23.64it/s]Encode all items:  43%|██████████████████▋                         | 71/167 [00:03<00:04, 22.94it/s]Encode all items:  44%|███████████████████▍                        | 74/167 [00:03<00:04, 22.54it/s]Encode all items:  46%|████████████████████▎                       | 77/167 [00:03<00:04, 22.27it/s]Encode all items:  48%|█████████████████████                       | 80/167 [00:03<00:03, 22.27it/s]Encode all items:  50%|█████████████████████▊                      | 83/167 [00:03<00:03, 22.79it/s]Encode all items:  51%|██████████████████████▋                     | 86/167 [00:03<00:03, 22.36it/s]Encode all items:  53%|███████████████████████▍                    | 89/167 [00:03<00:03, 23.25it/s]Encode all items:  55%|████████████████████████▏                   | 92/167 [00:03<00:03, 23.06it/s]Encode all items:  57%|█████████████████████████                   | 95/167 [00:04<00:03, 23.25it/s]Encode all items:  59%|█████████████████████████▊                  | 98/167 [00:04<00:02, 23.93it/s]Encode all items:  60%|██████████████████████████                 | 101/167 [00:04<00:02, 23.45it/s]Encode all items:  62%|██████████████████████████▊                | 104/167 [00:04<00:02, 23.67it/s]Encode all items:  64%|███████████████████████████▌               | 107/167 [00:04<00:02, 23.41it/s]Encode all items:  66%|████████████████████████████▎              | 110/167 [00:04<00:02, 23.06it/s]Encode all items:  68%|█████████████████████████████              | 113/167 [00:04<00:02, 22.92it/s]Encode all items:  69%|█████████████████████████████▊             | 116/167 [00:05<00:02, 23.22it/s]Encode all items:  71%|██████████████████████████████▋            | 119/167 [00:05<00:02, 23.45it/s]Encode all items:  73%|███████████████████████████████▍           | 122/167 [00:05<00:01, 23.52it/s]Encode all items:  75%|████████████████████████████████▏          | 125/167 [00:05<00:01, 23.64it/s]Encode all items:  77%|████████████████████████████████▉          | 128/167 [00:05<00:01, 23.31it/s]Encode all items:  78%|█████████████████████████████████▋         | 131/167 [00:05<00:01, 23.10it/s]Encode all items:  80%|██████████████████████████████████▌        | 134/167 [00:05<00:01, 23.82it/s]Encode all items:  82%|███████████████████████████████████▎       | 137/167 [00:05<00:01, 24.36it/s]Encode all items:  84%|████████████████████████████████████       | 140/167 [00:06<00:01, 23.35it/s]Encode all items:  86%|████████████████████████████████████▊      | 143/167 [00:06<00:01, 23.13it/s]Encode all items:  87%|█████████████████████████████████████▌     | 146/167 [00:06<00:00, 23.04it/s]Encode all items:  89%|██████████████████████████████████████▎    | 149/167 [00:06<00:00, 22.82it/s]Encode all items:  91%|███████████████████████████████████████▏   | 152/167 [00:06<00:00, 22.76it/s]Encode all items:  93%|███████████████████████████████████████▉   | 155/167 [00:06<00:00, 22.72it/s]Encode all items:  95%|████████████████████████████████████████▋  | 158/167 [00:06<00:00, 23.13it/s]Encode all items:  96%|█████████████████████████████████████████▍ | 161/167 [00:06<00:00, 23.36it/s]Encode all items:  98%|██████████████████████████████████████████▏| 164/167 [00:07<00:00, 24.01it/s]Encode all items: 100%|███████████████████████████████████████████| 167/167 [00:07<00:00, 24.01it/s]Encode all items: 100%|███████████████████████████████████████████| 167/167 [00:07<00:00, 23.27it/s]
Initalize item embeddings from vectors.
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]/gpfs/home2/scur2746/recformer_toy/RecFormer/python_scripts/finetune_optimized.py:116: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/gpfs/home2/scur2746/recformer_env/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
Training:  33%|██████████████████▎                                    | 1/3 [00:01<00:02,  1.26s/it]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.37it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.89it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.50it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.24it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.08it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.67it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.13it/s]
Epoch: 1. Dev set: {'NDCG@10': 0.032484992717703186, 'Recall@10': 0.052083333333333336, 'NDCG@50': 0.050016930947701134, 'Recall@50': 0.13541666666666666, 'MRR': 0.03199849914138516, 'AUC': 0.7354984084765116}
Save the best model.

Epoch 2/50
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.21it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.94it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.43it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.96it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.25it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.08it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.66it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.10it/s]
Epoch: 2. Dev set: {'NDCG@10': 0.032484992717703186, 'Recall@10': 0.052083333333333336, 'NDCG@50': 0.04999133696158727, 'Recall@50': 0.13541666666666666, 'MRR': 0.03202832071110606, 'AUC': 0.7363802989323934}
No improvement. Patience: 4/5

Epoch 3/50
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.21it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.94it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.45it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.00it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.27it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.12it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.70it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.12it/s]
Epoch: 3. Dev set: {'NDCG@10': 0.032484992717703186, 'Recall@10': 0.052083333333333336, 'NDCG@50': 0.05009604866305987, 'Recall@50': 0.13541666666666666, 'MRR': 0.03218068337688843, 'AUC': 0.7374558051427206}
No improvement. Patience: 3/5

Epoch 4/50
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.19it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.90it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.40it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.93it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.24it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.10it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.68it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.11it/s]
Epoch: 4. Dev set: {'NDCG@10': 0.03216576731453339, 'Recall@10': 0.052083333333333336, 'NDCG@50': 0.05399558072288831, 'Recall@50': 0.15625, 'MRR': 0.0322060144195954, 'AUC': 0.7386955817540487}
No improvement. Patience: 2/5

Epoch 5/50
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.18it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.91it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.02it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.73it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.22it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.05it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.62it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.06it/s]
Epoch: 5. Dev set: {'NDCG@10': 0.04096077320476373, 'Recall@10': 0.08333333333333333, 'NDCG@50': 0.05316160122553507, 'Recall@50': 0.14583333333333334, 'MRR': 0.03291398473083973, 'AUC': 0.7393271923065186}
Save the best model.

Epoch 6/50
Re-encoding items...
Encode all items:   0%|                                                     | 0/167 [00:00<?, ?it/s]Encode all items:   2%|▊                                            | 3/167 [00:00<00:07, 22.67it/s]Encode all items:   4%|█▌                                           | 6/167 [00:00<00:07, 22.75it/s]Encode all items:   5%|██▍                                          | 9/167 [00:00<00:06, 22.81it/s]Encode all items:   7%|███▏                                        | 12/167 [00:00<00:06, 22.33it/s]Encode all items:   9%|███▉                                        | 15/167 [00:00<00:06, 22.52it/s]Encode all items:  11%|████▋                                       | 18/167 [00:00<00:06, 23.06it/s]Encode all items:  13%|█████▌                                      | 21/167 [00:00<00:06, 23.01it/s]Encode all items:  14%|██████▎                                     | 24/167 [00:01<00:06, 23.37it/s]Encode all items:  16%|███████                                     | 27/167 [00:01<00:05, 23.60it/s]Encode all items:  18%|███████▉                                    | 30/167 [00:01<00:05, 23.77it/s]Encode all items:  20%|████████▋                                   | 33/167 [00:01<00:05, 23.88it/s]Encode all items:  22%|█████████▍                                  | 36/167 [00:01<00:05, 23.97it/s]Encode all items:  23%|██████████▎                                 | 39/167 [00:01<00:05, 24.03it/s]Encode all items:  25%|███████████                                 | 42/167 [00:01<00:05, 23.67it/s]Encode all items:  27%|███████████▊                                | 45/167 [00:01<00:05, 24.25it/s]Encode all items:  29%|████████████▋                               | 48/167 [00:02<00:04, 24.22it/s]Encode all items:  31%|█████████████▍                              | 51/167 [00:02<00:04, 24.22it/s]Encode all items:  32%|██████████████▏                             | 54/167 [00:02<00:04, 23.78it/s]Encode all items:  34%|███████████████                             | 57/167 [00:02<00:04, 23.49it/s]Encode all items:  36%|███████████████▊                            | 60/167 [00:02<00:04, 23.18it/s]Encode all items:  38%|████████████████▌                           | 63/167 [00:02<00:04, 23.44it/s]Encode all items:  40%|█████████████████▍                          | 66/167 [00:02<00:04, 23.64it/s]Encode all items:  41%|██████████████████▏                         | 69/167 [00:02<00:04, 23.39it/s]Encode all items:  43%|██████████████████▉                         | 72/167 [00:03<00:04, 22.83it/s]Encode all items:  45%|███████████████████▊                        | 75/167 [00:03<00:04, 22.45it/s]Encode all items:  47%|████████████████████▌                       | 78/167 [00:03<00:04, 22.20it/s]Encode all items:  49%|█████████████████████▎                      | 81/167 [00:03<00:03, 22.38it/s]Encode all items:  50%|██████████████████████▏                     | 84/167 [00:03<00:03, 22.88it/s]Encode all items:  52%|██████████████████████▉                     | 87/167 [00:03<00:03, 22.86it/s]Encode all items:  54%|███████████████████████▋                    | 90/167 [00:03<00:03, 23.62it/s]Encode all items:  56%|████████████████████████▌                   | 93/167 [00:03<00:03, 22.99it/s]Encode all items:  57%|█████████████████████████▎                  | 96/167 [00:04<00:02, 23.71it/s]Encode all items:  59%|██████████████████████████                  | 99/167 [00:04<00:02, 24.26it/s]Encode all items:  61%|██████████████████████████▎                | 102/167 [00:04<00:02, 23.80it/s]Encode all items:  63%|███████████████████████████                | 105/167 [00:04<00:02, 23.50it/s]Encode all items:  65%|███████████████████████████▊               | 108/167 [00:04<00:02, 23.30it/s]Encode all items:  66%|████████████████████████████▌              | 111/167 [00:04<00:02, 23.00it/s]Encode all items:  68%|█████████████████████████████▎             | 114/167 [00:04<00:02, 23.31it/s]Encode all items:  70%|██████████████████████████████▏            | 117/167 [00:05<00:02, 23.14it/s]Encode all items:  72%|██████████████████████████████▉            | 120/167 [00:05<00:01, 23.80it/s]Encode all items:  74%|███████████████████████████████▋           | 123/167 [00:05<00:01, 23.89it/s]Encode all items:  75%|████████████████████████████████▍          | 126/167 [00:05<00:01, 23.94it/s]Encode all items:  77%|█████████████████████████████████▏         | 129/167 [00:05<00:01, 23.56it/s]Encode all items:  79%|█████████████████████████████████▉         | 132/167 [00:05<00:01, 23.32it/s]Encode all items:  81%|██████████████████████████████████▊        | 135/167 [00:05<00:01, 23.95it/s]Encode all items:  83%|███████████████████████████████████▌       | 138/167 [00:05<00:01, 24.01it/s]Encode all items:  84%|████████████████████████████████████▎      | 141/167 [00:06<00:01, 23.24it/s]Encode all items:  86%|█████████████████████████████████████      | 144/167 [00:06<00:00, 23.10it/s]Encode all items:  88%|█████████████████████████████████████▊     | 147/167 [00:06<00:00, 23.01it/s]Encode all items:  90%|██████████████████████████████████████▌    | 150/167 [00:06<00:00, 22.94it/s]Encode all items:  92%|███████████████████████████████████████▍   | 153/167 [00:06<00:00, 22.91it/s]Encode all items:  93%|████████████████████████████████████████▏  | 156/167 [00:06<00:00, 22.87it/s]Encode all items:  95%|████████████████████████████████████████▉  | 159/167 [00:06<00:00, 23.62it/s]Encode all items:  97%|█████████████████████████████████████████▋ | 162/167 [00:06<00:00, 23.72it/s]Encode all items:  99%|██████████████████████████████████████████▍| 165/167 [00:07<00:00, 23.85it/s]Encode all items: 100%|███████████████████████████████████████████| 167/167 [00:07<00:00, 23.43it/s]
Initalize item embeddings from vectors.
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.18it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.89it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.40it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.95it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.25it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.10it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.68it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.12it/s]
Epoch: 6. Dev set: {'NDCG@10': 0.040004199370741844, 'Recall@10': 0.07291666666666667, 'NDCG@50': 0.05343295137087504, 'Recall@50': 0.13541666666666666, 'MRR': 0.035064022056758404, 'AUC': 0.7394660115242004}
No improvement. Patience: 4/5

Epoch 7/50
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.17it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.89it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.38it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.93it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.23it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.05it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.61it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.09it/s]
Epoch: 7. Dev set: {'NDCG@10': 0.03988593506316344, 'Recall@10': 0.07291666666666667, 'NDCG@50': 0.05348767961064974, 'Recall@50': 0.13541666666666666, 'MRR': 0.035068344014386334, 'AUC': 0.7409814397493998}
No improvement. Patience: 3/5

Epoch 8/50
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.17it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.91it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.40it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.91it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.21it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.05it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.63it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.08it/s]
Epoch: 8. Dev set: {'NDCG@10': 0.042085537066062294, 'Recall@10': 0.07291666666666667, 'NDCG@50': 0.05730286737283071, 'Recall@50': 0.14583333333333334, 'MRR': 0.037594687193632126, 'AUC': 0.7405610879262289}
Save the best model.

Epoch 9/50
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.18it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.90it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.39it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.92it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.23it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.04it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.63it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.09it/s]
Epoch: 9. Dev set: {'NDCG@10': 0.041971905156970024, 'Recall@10': 0.07291666666666667, 'NDCG@50': 0.05544433742761612, 'Recall@50': 0.13541666666666666, 'MRR': 0.037478990852832794, 'AUC': 0.7393174171447754}
No improvement. Patience: 4/5

Epoch 10/50
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.18it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.91it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.40it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.96it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.25it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.77it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.39it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.93it/s]
Epoch: 10. Dev set: {'NDCG@10': 0.04189940790335337, 'Recall@10': 0.07291666666666667, 'NDCG@50': 0.05522911623120308, 'Recall@50': 0.13541666666666666, 'MRR': 0.03737765612701575, 'AUC': 0.7368202606836954}
No improvement. Patience: 3/5

Epoch 11/50
Re-encoding items...
Encode all items:   0%|                                                     | 0/167 [00:00<?, ?it/s]Encode all items:   2%|▊                                            | 3/167 [00:00<00:07, 22.68it/s]Encode all items:   4%|█▌                                           | 6/167 [00:00<00:07, 22.76it/s]Encode all items:   5%|██▍                                          | 9/167 [00:00<00:06, 22.78it/s]Encode all items:   7%|███▏                                        | 12/167 [00:00<00:06, 22.32it/s]Encode all items:   9%|███▉                                        | 15/167 [00:00<00:06, 22.50it/s]Encode all items:  11%|████▋                                       | 18/167 [00:00<00:06, 23.01it/s]Encode all items:  13%|█████▌                                      | 21/167 [00:00<00:06, 22.96it/s]Encode all items:  14%|██████▎                                     | 24/167 [00:01<00:06, 23.31it/s]Encode all items:  16%|███████                                     | 27/167 [00:01<00:05, 23.56it/s]Encode all items:  18%|███████▉                                    | 30/167 [00:01<00:05, 23.62it/s]Encode all items:  20%|████████▋                                   | 33/167 [00:01<00:05, 23.78it/s]Encode all items:  22%|█████████▍                                  | 36/167 [00:01<00:05, 23.88it/s]Encode all items:  23%|██████████▎                                 | 39/167 [00:01<00:05, 23.95it/s]Encode all items:  25%|███████████                                 | 42/167 [00:01<00:05, 23.60it/s]Encode all items:  27%|███████████▊                                | 45/167 [00:01<00:05, 24.17it/s]Encode all items:  29%|████████████▋                               | 48/167 [00:02<00:04, 24.15it/s]Encode all items:  31%|█████████████▍                              | 51/167 [00:02<00:04, 24.14it/s]Encode all items:  32%|██████████████▏                             | 54/167 [00:02<00:04, 23.71it/s]Encode all items:  34%|███████████████                             | 57/167 [00:02<00:04, 23.43it/s]Encode all items:  36%|███████████████▊                            | 60/167 [00:02<00:04, 23.22it/s]Encode all items:  38%|████████████████▌                           | 63/167 [00:02<00:04, 23.48it/s]Encode all items:  40%|█████████████████▍                          | 66/167 [00:02<00:04, 23.67it/s]Encode all items:  41%|██████████████████▏                         | 69/167 [00:02<00:04, 23.40it/s]Encode all items:  43%|██████████████████▉                         | 72/167 [00:03<00:04, 22.84it/s]Encode all items:  45%|███████████████████▊                        | 75/167 [00:03<00:04, 22.45it/s]Encode all items:  47%|████████████████████▌                       | 78/167 [00:03<00:04, 22.13it/s]Encode all items:  49%|█████████████████████▎                      | 81/167 [00:03<00:03, 22.31it/s]Encode all items:  50%|██████████████████████▏                     | 84/167 [00:03<00:03, 22.81it/s]Encode all items:  52%|██████████████████████▉                     | 87/167 [00:03<00:03, 22.79it/s]Encode all items:  54%|███████████████████████▋                    | 90/167 [00:03<00:03, 23.57it/s]Encode all items:  56%|████████████████████████▌                   | 93/167 [00:04<00:03, 22.94it/s]Encode all items:  57%|█████████████████████████▎                  | 96/167 [00:04<00:03, 23.65it/s]Encode all items:  59%|██████████████████████████                  | 99/167 [00:04<00:02, 24.18it/s]Encode all items:  61%|██████████████████████████▎                | 102/167 [00:04<00:02, 23.74it/s]Encode all items:  63%|███████████████████████████                | 105/167 [00:04<00:02, 23.44it/s]Encode all items:  65%|███████████████████████████▊               | 108/167 [00:04<00:02, 23.24it/s]Encode all items:  66%|████████████████████████████▌              | 111/167 [00:04<00:02, 23.09it/s]Encode all items:  68%|█████████████████████████████▎             | 114/167 [00:04<00:02, 23.37it/s]Encode all items:  70%|██████████████████████████████▏            | 117/167 [00:05<00:02, 23.19it/s]Encode all items:  72%|██████████████████████████████▉            | 120/167 [00:05<00:01, 23.85it/s]Encode all items:  74%|███████████████████████████████▋           | 123/167 [00:05<00:01, 23.92it/s]Encode all items:  75%|████████████████████████████████▍          | 126/167 [00:05<00:01, 23.97it/s]Encode all items:  77%|█████████████████████████████████▏         | 129/167 [00:05<00:01, 23.59it/s]Encode all items:  79%|█████████████████████████████████▉         | 132/167 [00:05<00:01, 23.33it/s]Encode all items:  81%|██████████████████████████████████▊        | 135/167 [00:05<00:01, 23.96it/s]Encode all items:  83%|███████████████████████████████████▌       | 138/167 [00:05<00:01, 24.02it/s]Encode all items:  84%|████████████████████████████████████▎      | 141/167 [00:06<00:01, 23.24it/s]Encode all items:  86%|█████████████████████████████████████      | 144/167 [00:06<00:00, 23.09it/s]Encode all items:  88%|█████████████████████████████████████▊     | 147/167 [00:06<00:00, 22.99it/s]Encode all items:  90%|██████████████████████████████████████▌    | 150/167 [00:06<00:00, 22.92it/s]Encode all items:  92%|███████████████████████████████████████▍   | 153/167 [00:06<00:00, 22.87it/s]Encode all items:  93%|████████████████████████████████████████▏  | 156/167 [00:06<00:00, 22.84it/s]Encode all items:  95%|████████████████████████████████████████▉  | 159/167 [00:06<00:00, 23.58it/s]Encode all items:  97%|█████████████████████████████████████████▋ | 162/167 [00:06<00:00, 23.71it/s]Encode all items:  99%|██████████████████████████████████████████▍| 165/167 [00:07<00:00, 23.82it/s]Encode all items: 100%|███████████████████████████████████████████| 167/167 [00:07<00:00, 23.40it/s]
Initalize item embeddings from vectors.
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.18it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.88it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.38it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.94it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.24it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.10it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.67it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.13it/s]
Epoch: 11. Dev set: {'NDCG@10': 0.04334243138631185, 'Recall@10': 0.07291666666666667, 'NDCG@50': 0.06168091297149658, 'Recall@50': 0.15625, 'MRR': 0.0399020550151666, 'AUC': 0.7388520042101542}
Save the best model.

Epoch 12/50
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.17it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.89it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.40it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.94it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.23it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.08it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.68it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.10it/s]
Epoch: 12. Dev set: {'NDCG@10': 0.046434479455153145, 'Recall@10': 0.08333333333333333, 'NDCG@50': 0.0625303586324056, 'Recall@50': 0.15625, 'MRR': 0.040593989193439484, 'AUC': 0.7366091012954712}
Save the best model.

Epoch 13/50
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.17it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.87it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.36it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.91it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.24it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.09it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.68it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.11it/s]
Epoch: 13. Dev set: {'NDCG@10': 0.04712924671669801, 'Recall@10': 0.08333333333333333, 'NDCG@50': 0.06168245027462641, 'Recall@50': 0.14583333333333334, 'MRR': 0.04166510949532191, 'AUC': 0.735332171122233}
Save the best model.

Epoch 14/50
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.20it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.91it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.42it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.96it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.23it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.09it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.67it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.09it/s]
Epoch: 14. Dev set: {'NDCG@10': 0.05485404655337334, 'Recall@10': 0.08333333333333333, 'NDCG@50': 0.0695835550626119, 'Recall@50': 0.14583333333333334, 'MRR': 0.05152821665008863, 'AUC': 0.7350134452184042}
Save the best model.

Epoch 15/50
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.17it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.85it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.38it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.89it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.21it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.05it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.69it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.09it/s]
Epoch: 15. Dev set: {'NDCG@10': 0.05460179348786672, 'Recall@10': 0.09375, 'NDCG@50': 0.06465695301691692, 'Recall@50': 0.13541666666666666, 'MRR': 0.04710895195603371, 'AUC': 0.734759251276652}
No improvement. Patience: 4/5

Epoch 16/50
Re-encoding items...
Encode all items:   0%|                                                     | 0/167 [00:00<?, ?it/s]Encode all items:   2%|▊                                            | 3/167 [00:00<00:07, 22.62it/s]Encode all items:   4%|█▌                                           | 6/167 [00:00<00:07, 22.62it/s]Encode all items:   5%|██▍                                          | 9/167 [00:00<00:06, 22.68it/s]Encode all items:   7%|███▏                                        | 12/167 [00:00<00:06, 22.26it/s]Encode all items:   9%|███▉                                        | 15/167 [00:00<00:06, 22.39it/s]Encode all items:  11%|████▋                                       | 18/167 [00:00<00:06, 22.92it/s]Encode all items:  13%|█████▌                                      | 21/167 [00:00<00:06, 22.88it/s]Encode all items:  14%|██████▎                                     | 24/167 [00:01<00:06, 23.25it/s]Encode all items:  16%|███████                                     | 27/167 [00:01<00:05, 23.49it/s]Encode all items:  18%|███████▉                                    | 30/167 [00:01<00:05, 23.67it/s]Encode all items:  20%|████████▋                                   | 33/167 [00:01<00:05, 23.80it/s]Encode all items:  22%|█████████▍                                  | 36/167 [00:01<00:05, 23.89it/s]Encode all items:  23%|██████████▎                                 | 39/167 [00:01<00:05, 23.94it/s]Encode all items:  25%|███████████                                 | 42/167 [00:01<00:05, 23.54it/s]Encode all items:  27%|███████████▊                                | 45/167 [00:01<00:05, 24.11it/s]Encode all items:  29%|████████████▋                               | 48/167 [00:02<00:04, 24.10it/s]Encode all items:  31%|█████████████▍                              | 51/167 [00:02<00:04, 24.11it/s]Encode all items:  32%|██████████████▏                             | 54/167 [00:02<00:04, 23.69it/s]Encode all items:  34%|███████████████                             | 57/167 [00:02<00:04, 23.40it/s]Encode all items:  36%|███████████████▊                            | 60/167 [00:02<00:04, 23.16it/s]Encode all items:  38%|████████████████▌                           | 63/167 [00:02<00:04, 23.41it/s]Encode all items:  40%|█████████████████▍                          | 66/167 [00:02<00:04, 23.59it/s]Encode all items:  41%|██████████████████▏                         | 69/167 [00:02<00:04, 23.34it/s]Encode all items:  43%|██████████████████▉                         | 72/167 [00:03<00:04, 22.79it/s]Encode all items:  45%|███████████████████▊                        | 75/167 [00:03<00:04, 22.43it/s]Encode all items:  47%|████████████████████▌                       | 78/167 [00:03<00:04, 22.18it/s]Encode all items:  49%|█████████████████████▎                      | 81/167 [00:03<00:03, 22.31it/s]Encode all items:  50%|██████████████████████▏                     | 84/167 [00:03<00:03, 22.82it/s]Encode all items:  52%|██████████████████████▉                     | 87/167 [00:03<00:03, 22.79it/s]Encode all items:  54%|███████████████████████▋                    | 90/167 [00:03<00:03, 23.54it/s]Encode all items:  56%|████████████████████████▌                   | 93/167 [00:04<00:03, 22.92it/s]Encode all items:  57%|█████████████████████████▎                  | 96/167 [00:04<00:03, 23.63it/s]Encode all items:  59%|██████████████████████████                  | 99/167 [00:04<00:02, 24.09it/s]Encode all items:  61%|██████████████████████████▎                | 102/167 [00:04<00:02, 23.67it/s]Encode all items:  63%|███████████████████████████                | 105/167 [00:04<00:02, 23.38it/s]Encode all items:  65%|███████████████████████████▊               | 108/167 [00:04<00:02, 23.19it/s]Encode all items:  66%|████████████████████████████▌              | 111/167 [00:04<00:02, 23.05it/s]Encode all items:  68%|█████████████████████████████▎             | 114/167 [00:04<00:02, 23.34it/s]Encode all items:  70%|██████████████████████████████▏            | 117/167 [00:05<00:02, 23.15it/s]Encode all items:  72%|██████████████████████████████▉            | 120/167 [00:05<00:01, 23.81it/s]Encode all items:  74%|███████████████████████████████▋           | 123/167 [00:05<00:01, 23.89it/s]Encode all items:  75%|████████████████████████████████▍          | 126/167 [00:05<00:01, 23.93it/s]Encode all items:  77%|█████████████████████████████████▏         | 129/167 [00:05<00:01, 23.57it/s]Encode all items:  79%|█████████████████████████████████▉         | 132/167 [00:05<00:01, 23.32it/s]Encode all items:  81%|██████████████████████████████████▊        | 135/167 [00:05<00:01, 23.95it/s]Encode all items:  83%|███████████████████████████████████▌       | 138/167 [00:05<00:01, 23.96it/s]Encode all items:  84%|████████████████████████████████████▎      | 141/167 [00:06<00:01, 23.20it/s]Encode all items:  86%|█████████████████████████████████████      | 144/167 [00:06<00:00, 23.06it/s]Encode all items:  88%|█████████████████████████████████████▊     | 147/167 [00:06<00:00, 22.96it/s]Encode all items:  90%|██████████████████████████████████████▌    | 150/167 [00:06<00:00, 22.90it/s]Encode all items:  92%|███████████████████████████████████████▍   | 153/167 [00:06<00:00, 22.86it/s]Encode all items:  93%|████████████████████████████████████████▏  | 156/167 [00:06<00:00, 22.81it/s]Encode all items:  95%|████████████████████████████████████████▉  | 159/167 [00:06<00:00, 23.55it/s]Encode all items:  97%|█████████████████████████████████████████▋ | 162/167 [00:06<00:00, 23.70it/s]Encode all items:  99%|██████████████████████████████████████████▍| 165/167 [00:07<00:00, 23.82it/s]Encode all items: 100%|███████████████████████████████████████████| 167/167 [00:07<00:00, 23.36it/s]
Initalize item embeddings from vectors.
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:01<00:02,  1.01s/it]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.69it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.20it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.76it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.24it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.08it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.66it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.10it/s]
Epoch: 16. Dev set: {'NDCG@10': 0.059796757996082306, 'Recall@10': 0.09375, 'NDCG@50': 0.07550241177280743, 'Recall@50': 0.16666666666666666, 'MRR': 0.05379891023039818, 'AUC': 0.7331870595614115}
Save the best model.

Epoch 17/50
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.16it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.87it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.38it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.92it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.21it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.06it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.63it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.08it/s]
Epoch: 17. Dev set: {'NDCG@10': 0.06352996826171875, 'Recall@10': 0.10416666666666667, 'NDCG@50': 0.07445517927408218, 'Recall@50': 0.15625, 'MRR': 0.05464534337321917, 'AUC': 0.7288968165715536}
Save the best model.

Epoch 18/50
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.17it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.90it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.41it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.95it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.22it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.05it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.63it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.07it/s]
Epoch: 18. Dev set: {'NDCG@10': 0.0616974929968516, 'Recall@10': 0.09375, 'NDCG@50': 0.07574339086810748, 'Recall@50': 0.15625, 'MRR': 0.05602019652724266, 'AUC': 0.7241450746854147}
No improvement. Patience: 4/5

Epoch 19/50
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.18it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.90it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.41it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.95it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.24it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.07it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.65it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.10it/s]
Epoch: 19. Dev set: {'NDCG@10': 0.060518876959880195, 'Recall@10': 0.09375, 'NDCG@50': 0.07450080787142117, 'Recall@50': 0.15625, 'MRR': 0.0545621228714784, 'AUC': 0.7185818354288737}
No improvement. Patience: 3/5

Epoch 20/50
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.16it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.87it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.38it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.89it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.21it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.03it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.61it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.07it/s]
Epoch: 20. Dev set: {'NDCG@10': 0.059796757996082306, 'Recall@10': 0.09375, 'NDCG@50': 0.07346287742257118, 'Recall@50': 0.15625, 'MRR': 0.05350751802325249, 'AUC': 0.7152595122655233}
No improvement. Patience: 2/5

Epoch 21/50
Re-encoding items...
Encode all items:   0%|                                                     | 0/167 [00:00<?, ?it/s]Encode all items:   2%|▊                                            | 3/167 [00:00<00:07, 22.64it/s]Encode all items:   4%|█▌                                           | 6/167 [00:00<00:07, 22.75it/s]Encode all items:   5%|██▍                                          | 9/167 [00:00<00:06, 22.78it/s]Encode all items:   7%|███▏                                        | 12/167 [00:00<00:06, 22.31it/s]Encode all items:   9%|███▉                                        | 15/167 [00:00<00:06, 22.47it/s]Encode all items:  11%|████▋                                       | 18/167 [00:00<00:06, 23.00it/s]Encode all items:  13%|█████▌                                      | 21/167 [00:00<00:06, 22.94it/s]Encode all items:  14%|██████▎                                     | 24/167 [00:01<00:06, 23.25it/s]Encode all items:  16%|███████                                     | 27/167 [00:01<00:05, 23.50it/s]Encode all items:  18%|███████▉                                    | 30/167 [00:01<00:05, 23.67it/s]Encode all items:  20%|████████▋                                   | 33/167 [00:01<00:05, 23.81it/s]Encode all items:  22%|█████████▍                                  | 36/167 [00:01<00:05, 23.90it/s]Encode all items:  23%|██████████▎                                 | 39/167 [00:01<00:05, 23.95it/s]Encode all items:  25%|███████████                                 | 42/167 [00:01<00:05, 23.60it/s]Encode all items:  27%|███████████▊                                | 45/167 [00:01<00:05, 24.15it/s]Encode all items:  29%|████████████▋                               | 48/167 [00:02<00:04, 24.11it/s]Encode all items:  31%|█████████████▍                              | 51/167 [00:02<00:04, 24.11it/s]Encode all items:  32%|██████████████▏                             | 54/167 [00:02<00:04, 23.67it/s]Encode all items:  34%|███████████████                             | 57/167 [00:02<00:04, 23.40it/s]Encode all items:  36%|███████████████▊                            | 60/167 [00:02<00:04, 23.21it/s]Encode all items:  38%|████████████████▌                           | 63/167 [00:02<00:04, 23.46it/s]Encode all items:  40%|█████████████████▍                          | 66/167 [00:02<00:04, 23.66it/s]Encode all items:  41%|██████████████████▏                         | 69/167 [00:02<00:04, 23.39it/s]Encode all items:  43%|██████████████████▉                         | 72/167 [00:03<00:04, 22.83it/s]Encode all items:  45%|███████████████████▊                        | 75/167 [00:03<00:04, 22.45it/s]Encode all items:  47%|████████████████████▌                       | 78/167 [00:03<00:04, 22.18it/s]Encode all items:  49%|█████████████████████▎                      | 81/167 [00:03<00:03, 22.35it/s]Encode all items:  50%|██████████████████████▏                     | 84/167 [00:03<00:03, 22.84it/s]Encode all items:  52%|██████████████████████▉                     | 87/167 [00:03<00:03, 22.80it/s]Encode all items:  54%|███████████████████████▋                    | 90/167 [00:03<00:03, 23.56it/s]Encode all items:  56%|████████████████████████▌                   | 93/167 [00:04<00:03, 22.94it/s]Encode all items:  57%|█████████████████████████▎                  | 96/167 [00:04<00:03, 23.64it/s]Encode all items:  59%|██████████████████████████                  | 99/167 [00:04<00:02, 24.17it/s]Encode all items:  61%|██████████████████████████▎                | 102/167 [00:04<00:02, 23.71it/s]Encode all items:  63%|███████████████████████████                | 105/167 [00:04<00:02, 23.42it/s]Encode all items:  65%|███████████████████████████▊               | 108/167 [00:04<00:02, 23.23it/s]Encode all items:  66%|████████████████████████████▌              | 111/167 [00:04<00:02, 23.09it/s]Encode all items:  68%|█████████████████████████████▎             | 114/167 [00:04<00:02, 23.37it/s]Encode all items:  70%|██████████████████████████████▏            | 117/167 [00:05<00:02, 23.20it/s]Encode all items:  72%|██████████████████████████████▉            | 120/167 [00:05<00:01, 23.85it/s]Encode all items:  74%|███████████████████████████████▋           | 123/167 [00:05<00:01, 23.91it/s]Encode all items:  75%|████████████████████████████████▍          | 126/167 [00:05<00:01, 23.94it/s]Encode all items:  77%|█████████████████████████████████▏         | 129/167 [00:05<00:01, 23.57it/s]Encode all items:  79%|█████████████████████████████████▉         | 132/167 [00:05<00:01, 23.31it/s]Encode all items:  81%|██████████████████████████████████▊        | 135/167 [00:05<00:01, 23.94it/s]Encode all items:  83%|███████████████████████████████████▌       | 138/167 [00:05<00:01, 23.96it/s]Encode all items:  84%|████████████████████████████████████▎      | 141/167 [00:06<00:01, 23.20it/s]Encode all items:  86%|█████████████████████████████████████      | 144/167 [00:06<00:00, 23.06it/s]Encode all items:  88%|█████████████████████████████████████▊     | 147/167 [00:06<00:00, 22.97it/s]Encode all items:  90%|██████████████████████████████████████▌    | 150/167 [00:06<00:00, 22.92it/s]Encode all items:  92%|███████████████████████████████████████▍   | 153/167 [00:06<00:00, 22.87it/s]Encode all items:  93%|████████████████████████████████████████▏  | 156/167 [00:06<00:00, 22.84it/s]Encode all items:  95%|████████████████████████████████████████▉  | 159/167 [00:06<00:00, 23.57it/s]Encode all items:  97%|█████████████████████████████████████████▋ | 162/167 [00:06<00:00, 23.70it/s]Encode all items:  99%|██████████████████████████████████████████▍| 165/167 [00:07<00:00, 23.82it/s]Encode all items: 100%|███████████████████████████████████████████| 167/167 [00:07<00:00, 23.39it/s]
Initalize item embeddings from vectors.
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:01<00:02,  1.01s/it]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.68it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.20it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.76it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.22it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.07it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.64it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.07it/s]
Epoch: 21. Dev set: {'NDCG@10': 0.06124099592367808, 'Recall@10': 0.09375, 'NDCG@50': 0.07674766704440117, 'Recall@50': 0.16666666666666666, 'MRR': 0.05532249932487806, 'AUC': 0.7192545334498087}
No improvement. Patience: 1/5

Epoch 22/50
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.18it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.89it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.41it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.94it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.23it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.08it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.65it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.11it/s]
Epoch: 22. Dev set: {'NDCG@10': 0.06019965186715126, 'Recall@10': 0.09375, 'NDCG@50': 0.07316110531489055, 'Recall@50': 0.15625, 'MRR': 0.053692816446224846, 'AUC': 0.7214563488960266}
No improvement. Patience: 0/5
Early stopping triggered in Stage 1

=== Stage 2: Fine-tuning with Best Model (patience=3) ===
Load best model from stage 1.

Stage 2 - Epoch 1/50
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.19it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.91it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.42it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.92it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.26it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.10it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.69it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.13it/s]
Epoch: 1. Dev set: {'NDCG@10': 0.05934026092290878, 'Recall@10': 0.09375, 'NDCG@50': 0.07277735322713852, 'Recall@50': 0.15625, 'MRR': 0.052959851920604706, 'AUC': 0.7324557503064474}
No improvement. Patience: 2/3

Stage 2 - Epoch 2/50
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.16it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.87it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.38it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.90it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.23it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.06it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.64it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.09it/s]
Epoch: 2. Dev set: {'NDCG@10': 0.0597431535522143, 'Recall@10': 0.09375, 'NDCG@50': 0.07119906196991603, 'Recall@50': 0.14583333333333334, 'MRR': 0.053424964348475136, 'AUC': 0.7352246443430582}
No improvement. Patience: 1/3

Stage 2 - Epoch 3/50
Training:   0%|                                                               | 0/3 [00:00<?, ?it/s]Training:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.16it/s]Training:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  1.87it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.37it/s]Training: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.91it/s]
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.23it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.07it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.67it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.11it/s]
Epoch: 3. Dev set: {'NDCG@10': 0.0597431535522143, 'Recall@10': 0.09375, 'NDCG@50': 0.07105053216218948, 'Recall@50': 0.14583333333333334, 'MRR': 0.053335923701524734, 'AUC': 0.7377823988596598}
No improvement. Patience: 0/3
Early stopping triggered in Stage 2

=== Final Evaluation ===
Test with the best checkpoint.
Evaluate:   0%|                                                               | 0/3 [00:00<?, ?it/s]Evaluate:  33%|██████████████████▎                                    | 1/3 [00:00<00:01,  1.21it/s]Evaluate:  67%|████████████████████████████████████▋                  | 2/3 [00:01<00:00,  2.04it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.19it/s]Evaluate: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  1.85it/s]
Final Test set: {'NDCG@10': 0.03782218446334203, 'Recall@10': 0.052083333333333336, 'NDCG@50': 0.04304735486706098, 'Recall@50': 0.07291666666666667, 'MRR': 0.03638960110644499, 'AUC': 0.6852003733317057}

=== Training Completed ===
Best NDCG@10: 0.063530
Total patience triggers: 5
=== Job Completion ===
End time: Mon Jun 23 10:43:34 CEST 2025
Job finished with exit code: 0

JOB STATISTICS
==============
Job ID: 12566058
Cluster: snellius
User/Group: scur2746/scur2746
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 64
CPU Utilized: 00:04:32
CPU Efficiency: 2.80% of 02:42:08 core-walltime
Job Wall-clock time: 00:02:32
Memory Utilized: 2.61 GB
Memory Efficiency: 1.09% of 240.00 GB (240.00 GB/node)
